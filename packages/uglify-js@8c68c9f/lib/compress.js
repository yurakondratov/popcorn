"use strict";function Compressor(e,n){return this instanceof Compressor?(TreeTransformer.call(this,this.before,this.after),this.options=defaults(e,{sequences:!n,properties:!n,dead_code:!n,drop_debugger:!n,unsafe:!1,unsafe_comps:!1,conditionals:!n,comparisons:!n,evaluate:!n,booleans:!n,loops:!n,unused:!n,hoist_funs:!n,keep_fargs:!0,keep_fnames:!1,hoist_vars:!1,if_return:!n,join_vars:!n,collapse_vars:!1,cascade:!n,side_effects:!n,pure_getters:!1,pure_funcs:null,negate_iife:!n,screw_ie8:!1,drop_console:!1,angular:!1,warnings:!0,global_defs:{},passes:1},!0),void(this.warnings_produced={})):new Compressor(e,n)}Compressor.prototype=new TreeTransformer,merge(Compressor.prototype,{option:function(e){return this.options[e]},compress:function(e){for(var n=+this.options.passes||1,t=0;t<n&&t<3;++t)t>0&&e.clear_opt_flags(),e=e.transform(this);return e},warn:function(e,n){if(this.options.warnings){var t=string_template(e,n);t in this.warnings_produced||(this.warnings_produced[t]=!0,AST_Node.warn.apply(AST_Node,arguments))}},clear_warnings:function(){this.warnings_produced={}},before:function(e,n,t){if(e._squeezed)return e;var r=!1;return e instanceof AST_Scope&&(e=e.hoist_declarations(this),r=!0),n(e,this),e=e.optimize(this),r&&e instanceof AST_Scope&&(e.drop_unused(this),n(e,this)),e._squeezed=!0,e}}),function(){function e(e,n){e.DEFMETHOD("optimize",function(e){var t=this;if(t._optimized)return t;if(e.has_directive("use asm"))return t;var r=n(t,e);return r._optimized=!0,r===t?r:r.transform(e)})}function n(e,n,t){return t||(t={}),n&&(t.start||(t.start=n.start),t.end||(t.end=n.end)),new e(t)}function t(e,t,r){if(t instanceof AST_Node)return t.transform(e);switch(typeof t){case"string":return n(AST_String,r,{value:t}).optimize(e);case"number":return isNaN(t)?n(AST_NaN,r):1/t<0?n(AST_UnaryPrefix,r,{operator:"-",expression:n(AST_Number,null,{value:-t})}):n(AST_Number,r,{value:t}).optimize(e);case"boolean":return n(t?AST_True:AST_False,r).optimize(e);case"undefined":return n(AST_Undefined,r).optimize(e);default:if(null===t)return n(AST_Null,r,{value:null}).optimize(e);if(t instanceof RegExp)return n(AST_RegExp,r,{value:t}).optimize(e);throw new Error(string_template("Can't handle constant of type: {type}",{type:typeof t}))}}function r(e,t,r){return e instanceof AST_Call&&e.expression===t&&(r instanceof AST_PropAccess||r instanceof AST_SymbolRef&&"eval"===r.name)?n(AST_Seq,t,{car:n(AST_Number,t,{value:0}),cdr:r}):r}function i(e){if(null===e)return[];if(e instanceof AST_BlockStatement)return e.body;if(e instanceof AST_EmptyStatement)return[];if(e instanceof AST_Statement)return[e];throw new Error("Can't convert thing to statement array")}function o(e){return null===e||(e instanceof AST_EmptyStatement||e instanceof AST_BlockStatement&&0==e.body.length)}function a(e){return e instanceof AST_Switch?e:(e instanceof AST_For||e instanceof AST_ForIn||e instanceof AST_DWLoop)&&e.body instanceof AST_BlockStatement?e.body:e}function s(e,t){function o(e,t){function i(e,n){return e instanceof AST_SymbolRef&&(n instanceof AST_Assign&&e===n.left||n instanceof AST_Unary&&n.expression===e&&("++"==n.operator||"--"==n.operator))}function a(o,a,c){if(i(o,a))return o;var _=r(a,o,v.value);return v.value=null,S.splice(A,1),0===S.length&&(e[u]=n(AST_EmptyStatement,s),f=!0),l.clear_opt_flags(),t.warn("Replacing "+(c?"constant":"variable")+" "+m+" [{file}:{line},{col}]",o.start),g=!0,_}for(var s=t.self(),f=!1,c=e.length;--c>=0;){var l=e[c];if(!(l instanceof AST_Definitions)){if([l,l.body,l.alternative,l.bcatch,l.bfinally].forEach(function(e){e&&e.body&&o(e.body,t)}),c<=0)break;var u=c-1,_=e[u];if(_ instanceof AST_Definitions){var S=_.definitions;if(null!=S)for(var p={},d=!1,T=!1,h={},A=S.length;--A>=0;){var v=S[A];if(null==v.value)break;var m=v.name.name;if(!m||!m.length)break;if(m in p)break;p[m]=!0;var y=s.find_variable&&s.find_variable(m);if(y&&y.references&&1===y.references.length&&"arguments"!=m){var b=y.references[0];if(b.scope.uses_eval||b.scope.uses_with)break;if(v.value instanceof AST_RegExp||!v.value.is_constant(t)){if(!(d|=T))if(b.scope===s){var w=new TreeWalker(function(e){e instanceof AST_SymbolRef&&i(e,w.parent())&&(h[e.name]=T=!0)});v.value.walk(w);var x=!1,k=new TreeTransformer(function(e){if(x)return e;var n=k.parent();return e instanceof AST_Lambda||e instanceof AST_Try||e instanceof AST_With||e instanceof AST_Case||e instanceof AST_IterationStatement||n instanceof AST_If&&e!==n.condition||n instanceof AST_Conditional&&e!==n.condition||n instanceof AST_Binary&&("&&"==n.operator||"||"==n.operator)&&e===n.right||n instanceof AST_Switch&&e!==n.expression?(d=x=!0,e):void 0},function(e){return x?e:e===b?(x=!0,a(e,k.parent(),!1)):(d|=e.has_side_effects(t))?(x=!0,e):T&&e instanceof AST_SymbolRef&&e.name in h?(d=!0,x=!0,e):void 0});l.transform(k)}else d|=v.value.has_side_effects(t)}else{var E=new TreeTransformer(function(e){if(e===b)return a(e,E.parent(),!0)});l.transform(E)}}else d=!0}}}}if(f)for(var B=e.length;--B>=0;)e.length>1&&e[B]instanceof AST_EmptyStatement&&e.splice(B,1);return e}function s(e){function r(e){return/@ngInject/.test(e.value)}function i(e){return e.argnames.map(function(e){return n(AST_String,e,{value:e.name})})}function o(e,t){return n(AST_Array,e,{elements:t})}function a(e,t){return n(AST_SimpleStatement,e,{body:n(AST_Assign,e,{operator:"=",left:n(AST_Dot,t,{expression:n(AST_SymbolRef,t,t),property:"$inject"}),right:o(e,i(e))})})}function s(e){e&&e.args&&(e.args.forEach(function(e,n,t){var a=e.start.comments_before;e instanceof AST_Lambda&&a.length&&r(a[0])&&(t[n]=o(e,i(e).concat(e)))}),e.expression&&e.expression.expression&&s(e.expression.expression))}return e.reduce(function(e,n){if(e.push(n),n.body&&n.body.args)s(n.body);else{var i=n.start,o=i.comments_before;if(o&&o.length>0){var f=o.pop();r(f)&&(n instanceof AST_Defun?e.push(a(n,n.name)):n instanceof AST_Definitions?n.definitions.forEach(function(n){n.value&&n.value instanceof AST_Lambda&&e.push(a(n.value,n.name))}):t.warn("Unknown statement marked with @ngInject [{file}:{line},{col}]",i))}}return e},[])}function l(e){var n=[];return e.reduce(function(e,t){return t instanceof AST_BlockStatement?(g=!0,e.push.apply(e,l(t.body))):t instanceof AST_EmptyStatement?g=!0:t instanceof AST_Directive?n.indexOf(t.value)<0?(e.push(t),n.push(t.value)):g=!0:e.push(t),e},[])}function _(e,t){function r(e){for(var n=0,t=e.length;--t>=0;){var r=e[t];if(r instanceof AST_If&&r.body instanceof AST_Return&&++n>1)return!0}return!1}var o=t.self(),s=r(e),c=o instanceof AST_Lambda,l=[];e:for(var _=e.length;--_>=0;){var S=e[_];switch(!0){case c&&S instanceof AST_Return&&!S.value&&0==l.length:g=!0;continue e;case S instanceof AST_If:if(S.body instanceof AST_Return){if((c&&0==l.length||l[0]instanceof AST_Return&&!l[0].value)&&!S.body.value&&!S.alternative){g=!0;var p=n(AST_SimpleStatement,S.condition,{body:S.condition});l.unshift(p);continue e}if(l[0]instanceof AST_Return&&S.body.value&&l[0].value&&!S.alternative){g=!0,S=S.clone(),S.alternative=l[0],l[0]=S.transform(t);continue e}if(s&&(0==l.length||l[0]instanceof AST_Return)&&S.body.value&&!S.alternative&&c){g=!0,S=S.clone(),S.alternative=l[0]||n(AST_Return,S,{value:n(AST_Undefined,S)}),l[0]=S.transform(t);continue e}if(!S.body.value&&c){g=!0,S=S.clone(),S.condition=S.condition.negate(t);var d=i(S.alternative).concat(l),T=f(d);S.body=n(AST_BlockStatement,S,{body:d}),S.alternative=null,l=T.concat([S.transform(t)]);continue e}if(t.option("sequences")&&1==l.length&&c&&l[0]instanceof AST_SimpleStatement&&(!S.alternative||S.alternative instanceof AST_SimpleStatement)){g=!0,l.push(n(AST_Return,l[0],{value:n(AST_Undefined,l[0])}).transform(t)),l=i(S.alternative).concat(l),l.unshift(S);continue e}}var h=u(S.body),A=h instanceof AST_LoopControl?t.loopcontrol_target(h.label):null;if(h&&(h instanceof AST_Return&&!h.value&&c||h instanceof AST_Continue&&o===a(A)||h instanceof AST_Break&&A instanceof AST_BlockStatement&&o===A)){h.label&&remove(h.label.thedef.references,h),g=!0;var d=i(S.body).slice(0,-1);S=S.clone(),S.condition=S.condition.negate(t),S.body=n(AST_BlockStatement,S,{body:i(S.alternative).concat(l)}),S.alternative=n(AST_BlockStatement,S,{body:d}),l=[S.transform(t)];continue e}var h=u(S.alternative),A=h instanceof AST_LoopControl?t.loopcontrol_target(h.label):null;if(h&&(h instanceof AST_Return&&!h.value&&c||h instanceof AST_Continue&&o===a(A)||h instanceof AST_Break&&A instanceof AST_BlockStatement&&o===A)){h.label&&remove(h.label.thedef.references,h),g=!0,S=S.clone(),S.body=n(AST_BlockStatement,S.body,{body:i(S.body).concat(l)}),S.alternative=n(AST_BlockStatement,S.alternative,{body:i(S.alternative).slice(0,-1)}),l=[S.transform(t)];continue e}l.unshift(S);break;default:l.unshift(S)}}return l}function S(e,n){var t=!1,r=e.length,i=n.self();return e=e.reduce(function(e,r){if(t)c(n,r,e);else{if(r instanceof AST_LoopControl){var o=n.loopcontrol_target(r.label);r instanceof AST_Break&&o instanceof AST_BlockStatement&&a(o)===i||r instanceof AST_Continue&&a(o)===i?r.label&&remove(r.label.thedef.references,r):e.push(r)}else e.push(r);u(r)&&(t=!0)}return e},[]),g=e.length!=r,e}function p(e,t){function r(){i=AST_Seq.from_array(i),i&&o.push(n(AST_SimpleStatement,i,{body:i})),i=[]}if(e.length<2)return e;var i=[],o=[];return e.forEach(function(e){e instanceof AST_SimpleStatement&&d(i)<2e3?i.push(e.body):(r(),o.push(e))}),r(),o=T(o,t),g=o.length!=e.length,o}function d(e){for(var n=0,t=0;t<e.length;++t){var r=e[t];r instanceof AST_Seq?n+=r.len():n++}return n}function T(e,t){function r(e){i.pop();var n=o.body;return n instanceof AST_Seq?n.add(e):n=AST_Seq.cons(n,e),n.transform(t)}var i=[],o=null;return e.forEach(function(e){if(o)if(e instanceof AST_For){var t={};try{o.body.walk(new TreeWalker(function(e){if(e instanceof AST_Binary&&"in"==e.operator)throw t})),!e.init||e.init instanceof AST_Definitions?e.init||(e.init=o.body,i.pop()):e.init=r(e.init)}catch(a){if(a!==t)throw a}}else e instanceof AST_If?e.condition=r(e.condition):e instanceof AST_With?e.expression=r(e.expression):e instanceof AST_Exit&&e.value?e.value=r(e.value):e instanceof AST_Exit?e.value=r(n(AST_Undefined,e)):e instanceof AST_Switch&&(e.expression=r(e.expression));i.push(e),o=e instanceof AST_SimpleStatement?e:null}),i}function h(e,n){var t=null;return e.reduce(function(e,n){return n instanceof AST_Definitions&&t&&t.TYPE==n.TYPE?(t.definitions=t.definitions.concat(n.definitions),g=!0):n instanceof AST_For&&t instanceof AST_Definitions&&(!n.init||n.init.TYPE==t.TYPE)?(g=!0,e.pop(),n.init?n.init.definitions=t.definitions.concat(n.init.definitions):n.init=t,e.push(n),t=n):(t=n,e.push(n)),e},[])}function A(e,t){e.forEach(function(e){e instanceof AST_SimpleStatement&&(e.body=function t(e){return e.transform(new TreeTransformer(function(e){if(e instanceof AST_New)return e;if(e instanceof AST_Call&&e.expression instanceof AST_Function)return n(AST_UnaryPrefix,e,{operator:"!",expression:e});if(e instanceof AST_Call)e.expression=t(e.expression);else if(e instanceof AST_Seq)e.car=t(e.car);else if(e instanceof AST_Conditional){var r=t(e.condition);if(r!==e.condition){e.condition=r;var i=e.consequent;e.consequent=e.alternative,e.alternative=i}}return e}))}(e.body))})}var g,v=10;do g=!1,t.option("angular")&&(e=s(e)),e=l(e),t.option("dead_code")&&(e=S(e,t)),t.option("if_return")&&(e=_(e,t)),t.option("sequences")&&(e=p(e,t)),t.option("join_vars")&&(e=h(e,t)),t.option("collapse_vars")&&(e=o(e,t));while(g&&v-- >0);return t.option("negate_iife")&&A(e,t),e}function f(e){for(var n=[],t=e.length-1;t>=0;--t){var r=e[t];r instanceof AST_Defun&&(e.splice(t,1),n.unshift(r))}return n}function c(e,n,t){n instanceof AST_Defun||e.warn("Dropping unreachable code [{file}:{line},{col}]",n.start),n.walk(new TreeWalker(function(n){return n instanceof AST_Definitions?(e.warn("Declarations in unreachable code! [{file}:{line},{col}]",n.start),n.remove_initializers(),t.push(n),!0):n instanceof AST_Defun?(t.push(n),!0):n instanceof AST_Scope||void 0}))}function l(e,n){return e.print_to_string().length>n.print_to_string().length?n:e}function u(e){return e&&e.aborts()}function _(e,t){function r(r){r=i(r),e.body instanceof AST_BlockStatement?(e.body=e.body.clone(),e.body.body=r.concat(e.body.body.slice(1)),e.body=e.body.transform(t)):e.body=n(AST_BlockStatement,e.body,{body:r}).transform(t),_(e,t)}var o=e.body instanceof AST_BlockStatement?e.body.body[0]:e.body;o instanceof AST_If&&(o.body instanceof AST_Break&&t.loopcontrol_target(o.body.label)===e?(e.condition?e.condition=n(AST_Binary,e.condition,{left:e.condition,operator:"&&",right:o.condition.negate(t)}):e.condition=o.condition.negate(t),r(o.alternative)):o.alternative instanceof AST_Break&&t.loopcontrol_target(o.alternative.label)===e&&(e.condition?e.condition=n(AST_Binary,e.condition,{left:e.condition,operator:"&&",right:o.condition}):e.condition=o.condition,r(o.body)))}function S(e,n){var t=n.option("pure_getters");n.options.pure_getters=!1;var r=e.has_side_effects(n);return n.options.pure_getters=t,r}function p(e,t){return t.option("booleans")&&t.in_boolean_context()&&!e.has_side_effects(t)?n(AST_True,e):e}e(AST_Node,function(e,n){return e}),AST_Node.DEFMETHOD("equivalent_to",function(e){return this.print_to_string()==e.print_to_string()}),AST_Node.DEFMETHOD("clear_opt_flags",function(){this.walk(new TreeWalker(function(e){e instanceof AST_Directive||e instanceof AST_Constant||(e._squeezed=!1,e._optimized=!1)}))}),function(e){var n=["!","delete"],t=["in","instanceof","==","!=","===","!==","<","<=",">=",">"];e(AST_Node,function(){return!1}),e(AST_UnaryPrefix,function(){return member(this.operator,n)}),e(AST_Binary,function(){return member(this.operator,t)||("&&"==this.operator||"||"==this.operator)&&this.left.is_boolean()&&this.right.is_boolean()}),e(AST_Conditional,function(){return this.consequent.is_boolean()&&this.alternative.is_boolean()}),e(AST_Assign,function(){return"="==this.operator&&this.right.is_boolean()}),e(AST_Seq,function(){return this.cdr.is_boolean()}),e(AST_True,function(){return!0}),e(AST_False,function(){return!0})}(function(e,n){e.DEFMETHOD("is_boolean",n)}),function(e){e(AST_Node,function(){return!1}),e(AST_String,function(){return!0}),e(AST_UnaryPrefix,function(){return"typeof"==this.operator}),e(AST_Binary,function(e){return"+"==this.operator&&(this.left.is_string(e)||this.right.is_string(e))}),e(AST_Assign,function(e){return("="==this.operator||"+="==this.operator)&&this.right.is_string(e)}),e(AST_Seq,function(e){return this.cdr.is_string(e)}),e(AST_Conditional,function(e){return this.consequent.is_string(e)&&this.alternative.is_string(e)}),e(AST_Call,function(e){return e.option("unsafe")&&this.expression instanceof AST_SymbolRef&&"String"==this.expression.name&&this.expression.undeclared()})}(function(e,n){e.DEFMETHOD("is_string",n)}),function(e){function n(e,n){if(!n)throw new Error("Compressor must be passed");return e._eval(n)}AST_Node.DEFMETHOD("evaluate",function(n){if(!n.option("evaluate"))return[this];try{var r=this._eval(n);return[l(t(n,r,this),this),r]}catch(i){if(i!==e)throw i;return[this]}}),AST_Node.DEFMETHOD("is_constant",function(e){return this instanceof AST_Constant||this instanceof AST_UnaryPrefix&&"!"==this.operator&&this.expression instanceof AST_Constant||this.evaluate(e).length>1}),AST_Node.DEFMETHOD("constant_value",function(e){if(this instanceof AST_Constant)return this.value;if(this instanceof AST_UnaryPrefix&&"!"==this.operator&&this.expression instanceof AST_Constant)return!this.expression.value;var n=this.evaluate(e);return n.length>1?n[1]:void 0}),e(AST_Statement,function(){throw new Error(string_template("Cannot evaluate a statement [{file}:{line},{col}]",this.start))}),e(AST_Function,function(){throw e}),e(AST_Node,function(){throw e}),e(AST_Constant,function(){return this.getValue()}),e(AST_UnaryPrefix,function(t){var r=this.expression;switch(this.operator){case"!":return!n(r,t);case"typeof":if(r instanceof AST_Function)return"function";if(r=n(r,t),r instanceof RegExp)throw e;return typeof r;case"void":return void n(r,t);case"~":return~n(r,t);case"-":return-n(r,t);case"+":return+n(r,t)}throw e}),e(AST_Binary,function(t){var r,i=this.left,o=this.right;switch(this.operator){case"&&":r=n(i,t)&&n(o,t);break;case"||":r=n(i,t)||n(o,t);break;case"|":r=n(i,t)|n(o,t);break;case"&":r=n(i,t)&n(o,t);break;case"^":r=n(i,t)^n(o,t);break;case"+":r=n(i,t)+n(o,t);break;case"*":r=n(i,t)*n(o,t);break;case"/":r=n(i,t)/n(o,t);break;case"%":r=n(i,t)%n(o,t);break;case"-":r=n(i,t)-n(o,t);break;case"<<":r=n(i,t)<<n(o,t);break;case">>":r=n(i,t)>>n(o,t);break;case">>>":r=n(i,t)>>>n(o,t);break;case"==":r=n(i,t)==n(o,t);break;case"===":r=n(i,t)===n(o,t);break;case"!=":r=n(i,t)!=n(o,t);break;case"!==":r=n(i,t)!==n(o,t);break;case"<":r=n(i,t)<n(o,t);break;case"<=":r=n(i,t)<=n(o,t);break;case">":r=n(i,t)>n(o,t);break;case">=":r=n(i,t)>=n(o,t);break;default:throw e}if(isNaN(r)&&t.find_parent(AST_With))throw e;return r}),e(AST_Conditional,function(e){return n(this.condition,e)?n(this.consequent,e):n(this.alternative,e)}),e(AST_SymbolRef,function(t){if(this._evaluating)throw e;this._evaluating=!0;try{var r=this.definition();if(r&&r.constant&&r.init)return n(r.init,t)}finally{this._evaluating=!1}throw e}),e(AST_Dot,function(t){if(t.option("unsafe")&&"length"==this.property){var r=n(this.expression,t);if("string"==typeof r)return r.length}throw e})}(function(e,n){e.DEFMETHOD("_eval",n)}),function(e){function t(e){return n(AST_UnaryPrefix,e,{operator:"!",expression:e})}e(AST_Node,function(){return t(this)}),e(AST_Statement,function(){throw new Error("Cannot negate a statement")}),e(AST_Function,function(){return t(this)}),e(AST_UnaryPrefix,function(){return"!"==this.operator?this.expression:t(this)}),e(AST_Seq,function(e){var n=this.clone();return n.cdr=n.cdr.negate(e),n}),e(AST_Conditional,function(e){var n=this.clone();return n.consequent=n.consequent.negate(e),n.alternative=n.alternative.negate(e),l(t(this),n)}),e(AST_Binary,function(e){var n=this.clone(),r=this.operator;if(e.option("unsafe_comps"))switch(r){case"<=":return n.operator=">",n;case"<":return n.operator=">=",n;case">=":return n.operator="<",n;case">":return n.operator="<=",n}switch(r){case"==":return n.operator="!=",n;case"!=":return n.operator="==",n;case"===":return n.operator="!==",n;case"!==":return n.operator="===",n;case"&&":return n.operator="||",n.left=n.left.negate(e),n.right=n.right.negate(e),l(t(this),n);case"||":return n.operator="&&",n.left=n.left.negate(e),n.right=n.right.negate(e),l(t(this),n)}return t(this)})}(function(e,n){e.DEFMETHOD("negate",function(e){return n.call(this,e)})}),function(e){e(AST_Node,function(e){return!0}),e(AST_EmptyStatement,function(e){return!1}),e(AST_Constant,function(e){return!1}),e(AST_This,function(e){return!1}),e(AST_Call,function(e){var n=e.option("pure_funcs");return!n||("function"==typeof n?n(this):n.indexOf(this.expression.print_to_string())<0)}),e(AST_Block,function(e){for(var n=this.body.length;--n>=0;)if(this.body[n].has_side_effects(e))return!0;return!1}),e(AST_SimpleStatement,function(e){return this.body.has_side_effects(e)}),e(AST_Defun,function(e){return!0}),e(AST_Function,function(e){return!1}),e(AST_Binary,function(e){return this.left.has_side_effects(e)||this.right.has_side_effects(e)}),e(AST_Assign,function(e){return!0}),e(AST_Conditional,function(e){return this.condition.has_side_effects(e)||this.consequent.has_side_effects(e)||this.alternative.has_side_effects(e)}),e(AST_Unary,function(e){return"delete"==this.operator||"++"==this.operator||"--"==this.operator||this.expression.has_side_effects(e)}),e(AST_SymbolRef,function(e){return this.global()&&this.undeclared()}),e(AST_Object,function(e){for(var n=this.properties.length;--n>=0;)if(this.properties[n].has_side_effects(e))return!0;return!1}),e(AST_ObjectProperty,function(e){return this.value.has_side_effects(e)}),e(AST_Array,function(e){for(var n=this.elements.length;--n>=0;)if(this.elements[n].has_side_effects(e))return!0;return!1}),e(AST_Dot,function(e){return!e.option("pure_getters")||this.expression.has_side_effects(e)}),e(AST_Sub,function(e){return!e.option("pure_getters")||(this.expression.has_side_effects(e)||this.property.has_side_effects(e))}),e(AST_PropAccess,function(e){return!e.option("pure_getters")}),e(AST_Seq,function(e){return this.car.has_side_effects(e)||this.cdr.has_side_effects(e)})}(function(e,n){e.DEFMETHOD("has_side_effects",n)}),function(e){function n(){var e=this.body.length;return e>0&&u(this.body[e-1])}e(AST_Statement,function(){return null}),e(AST_Jump,function(){return this}),e(AST_BlockStatement,n),e(AST_SwitchBranch,n),e(AST_If,function(){return this.alternative&&u(this.body)&&u(this.alternative)&&this})}(function(e,n){e.DEFMETHOD("aborts",n)}),e(AST_Directive,function(e,t){return"up"===t.has_directive(e.value)?n(AST_EmptyStatement,e):e}),e(AST_Debugger,function(e,t){return t.option("drop_debugger")?n(AST_EmptyStatement,e):e}),e(AST_LabeledStatement,function(e,t){return e.body instanceof AST_Break&&t.loopcontrol_target(e.body.label)===e.body?n(AST_EmptyStatement,e):0==e.label.references.length?e.body:e}),e(AST_Block,function(e,n){return e.body=s(e.body,n),e}),e(AST_BlockStatement,function(e,t){switch(e.body=s(e.body,t),e.body.length){case 1:return e.body[0];case 0:return n(AST_EmptyStatement,e)}return e}),AST_Scope.DEFMETHOD("drop_unused",function(e){var t=this;if(e.has_directive("use asm"))return t;if(e.option("unused")&&!(t instanceof AST_Toplevel)&&!t.uses_eval&&!t.uses_with){var r=[],i={},o=new Dictionary,a=this,s=new TreeWalker(function(n,f){if(n!==t){if(n instanceof AST_Defun)return o.add(n.name.name,n),!0;if(n instanceof AST_Definitions&&a===t)return n.definitions.forEach(function(n){n.value&&(o.add(n.name.name,n.value),n.value.has_side_effects(e)&&n.value.walk(s))}),!0;if(n instanceof AST_SymbolRef){var c=n.definition();return c.id in i||(i[c.id]=!0,r.push(c)),!0}if(n instanceof AST_Scope){var l=a;return a=n,f(),a=l,!0}}});t.walk(s);for(var f=0;f<r.length;++f)r[f].orig.forEach(function(e){var n=o.get(e.name);n&&n.forEach(function(e){var n=new TreeWalker(function(e){if(e instanceof AST_SymbolRef){var n=e.definition();n.id in i||(i[n.id]=!0,r.push(n))}});e.walk(n)})});var c=new TreeTransformer(function(r,o,a){if(r instanceof AST_Lambda&&!(r instanceof AST_Accessor)&&!e.option("keep_fargs"))for(var s=r.argnames,f=s.length;--f>=0;){var l=s[f];if(!l.unreferenced())break;s.pop(),e.warn("Dropping unused function argument {name} [{file}:{line},{col}]",{name:l.name,file:l.start.file,line:l.start.line,col:l.start.col})}if(r instanceof AST_Defun&&r!==t)return r.name.definition().id in i?r:(e.warn("Dropping unused function {name} [{file}:{line},{col}]",{name:r.name.name,file:r.name.start.file,line:r.name.start.line,col:r.name.start.col}),n(AST_EmptyStatement,r));if(r instanceof AST_Definitions&&!(c.parent()instanceof AST_ForIn)){var u=r.definitions.filter(function(n){if(n.name.definition().id in i)return!0;var t={name:n.name.name,file:n.name.start.file,line:n.name.start.line,col:n.name.start.col};return n.value&&n.value.has_side_effects(e)?(n._unused_side_effects=!0,e.warn("Side effects in initialization of unused variable {name} [{file}:{line},{col}]",t),!0):(e.warn("Dropping unused variable {name} [{file}:{line},{col}]",t),!1)});u=mergeSort(u,function(e,n){return!e.value&&n.value?-1:!n.value&&e.value?1:0});for(var _=[],f=0;f<u.length;){var S=u[f];S._unused_side_effects?(_.push(S.value),u.splice(f,1)):(_.length>0&&(_.push(S.value),S.value=AST_Seq.from_array(_),_=[]),++f)}return _=_.length>0?n(AST_BlockStatement,r,{body:[n(AST_SimpleStatement,r,{body:AST_Seq.from_array(_)})]}):null,0!=u.length||_?0==u.length?a?MAP.splice(_.body):_:(r.definitions=u,_?(_.body.unshift(r),a?MAP.splice(_.body):_):r):n(AST_EmptyStatement,r)}if(r instanceof AST_For&&(o(r,this),r.init instanceof AST_BlockStatement)){var p=r.init.body.slice(0,-1);return r.init=r.init.body.slice(-1)[0].body,p.push(r),a?MAP.splice(p):n(AST_BlockStatement,r,{body:p})}return r instanceof AST_Scope&&r!==t?r:void 0});t.transform(c)}}),AST_Scope.DEFMETHOD("hoist_declarations",function(e){var t=this;if(e.has_directive("use asm"))return t;var r=e.option("hoist_funs"),i=e.option("hoist_vars");if(r||i){var o=[],a=[],s=new Dictionary,f=0,c=0;t.walk(new TreeWalker(function(e){return e instanceof AST_Scope&&e!==t||(e instanceof AST_Var?(++c,!0):void 0)})),i=i&&c>1;var l=new TreeTransformer(function(e){if(e!==t){if(e instanceof AST_Directive)return o.push(e),n(AST_EmptyStatement,e);if(e instanceof AST_Defun&&r)return a.push(e),n(AST_EmptyStatement,e);if(e instanceof AST_Var&&i){e.definitions.forEach(function(e){s.set(e.name.name,e),++f});var c=e.to_assignments(),u=l.parent();if(u instanceof AST_ForIn&&u.init===e){if(null==c){var _=e.definitions[0].name;return n(AST_SymbolRef,_,_)}return c}return u instanceof AST_For&&u.init===e?c:c?n(AST_SimpleStatement,e,{body:c}):n(AST_EmptyStatement,e)}if(e instanceof AST_Scope)return e}});if(t=t.transform(l),f>0){var u=[];if(s.each(function(e,n){t instanceof AST_Lambda&&find_if(function(n){return n.name==e.name.name},t.argnames)?s.del(n):(e=e.clone(),e.value=null,u.push(e),s.set(n,e))}),u.length>0){for(var _=0;_<t.body.length;){if(t.body[_]instanceof AST_SimpleStatement){var S,p,d=t.body[_].body;if(d instanceof AST_Assign&&"="==d.operator&&(S=d.left)instanceof AST_Symbol&&s.has(S.name)){var T=s.get(S.name);if(T.value)break;T.value=d.right,remove(u,T),u.push(T),t.body.splice(_,1);continue}if(d instanceof AST_Seq&&(p=d.car)instanceof AST_Assign&&"="==p.operator&&(S=p.left)instanceof AST_Symbol&&s.has(S.name)){var T=s.get(S.name);if(T.value)break;T.value=p.right,remove(u,T),u.push(T),t.body[_].body=d.cdr;continue}}if(t.body[_]instanceof AST_EmptyStatement)t.body.splice(_,1);else{if(!(t.body[_]instanceof AST_BlockStatement))break;var h=[_,1].concat(t.body[_].body);t.body.splice.apply(t.body,h)}}u=n(AST_Var,t,{definitions:u}),a.push(u)}}t.body=o.concat(a,t.body)}return t}),e(AST_SimpleStatement,function(e,t){return t.option("side_effects")&&!e.body.has_side_effects(t)?(t.warn("Dropping side-effect-free statement [{file}:{line},{col}]",e.start),n(AST_EmptyStatement,e)):e}),e(AST_DWLoop,function(e,t){var r=e.condition.evaluate(t);if(e.condition=r[0],!t.option("loops"))return e;if(r.length>1){if(r[1])return n(AST_For,e,{body:e.body});if(e instanceof AST_While&&t.option("dead_code")){var i=[];return c(t,e.body,i),n(AST_BlockStatement,e,{body:i})}}return e}),e(AST_While,function(e,t){return t.option("loops")?(e=AST_DWLoop.prototype.optimize.call(e,t),e instanceof AST_While&&(_(e,t),e=n(AST_For,e,e).transform(t)),e):e}),e(AST_For,function(e,t){var r=e.condition;if(r&&(r=r.evaluate(t),e.condition=r[0]),!t.option("loops"))return e;if(r&&r.length>1&&!r[1]&&t.option("dead_code")){var i=[];return e.init instanceof AST_Statement?i.push(e.init):e.init&&i.push(n(AST_SimpleStatement,e.init,{body:e.init})),c(t,e.body,i),n(AST_BlockStatement,e,{body:i})}return _(e,t),e}),e(AST_If,function(e,t){if(!t.option("conditionals"))return e;var r=e.condition.evaluate(t);if(e.condition=r[0],r.length>1)if(r[1]){if(t.warn("Condition always true [{file}:{line},{col}]",e.condition.start),t.option("dead_code")){var i=[];return e.alternative&&c(t,e.alternative,i),i.push(e.body),n(AST_BlockStatement,e,{body:i}).transform(t)}}else if(t.warn("Condition always false [{file}:{line},{col}]",e.condition.start),t.option("dead_code")){var i=[];return c(t,e.body,i),e.alternative&&i.push(e.alternative),n(AST_BlockStatement,e,{body:i}).transform(t)}o(e.alternative)&&(e.alternative=null);var a=e.condition.negate(t),s=e.condition.print_to_string().length,f=a.print_to_string().length,l=f<s;if(e.alternative&&l){l=!1,e.condition=a;var _=e.body;e.body=e.alternative||n(AST_EmptyStatement),e.alternative=_}if(o(e.body)&&o(e.alternative))return n(AST_SimpleStatement,e.condition,{body:e.condition}).transform(t);if(e.body instanceof AST_SimpleStatement&&e.alternative instanceof AST_SimpleStatement)return n(AST_SimpleStatement,e,{body:n(AST_Conditional,e,{condition:e.condition,consequent:e.body.body,alternative:e.alternative.body})}).transform(t);if(o(e.alternative)&&e.body instanceof AST_SimpleStatement)return s===f&&!l&&e.condition instanceof AST_Binary&&"||"==e.condition.operator&&(l=!0),l?n(AST_SimpleStatement,e,{body:n(AST_Binary,e,{operator:"||",left:a,right:e.body.body})}).transform(t):n(AST_SimpleStatement,e,{body:n(AST_Binary,e,{operator:"&&",left:e.condition,right:e.body.body})}).transform(t);if(e.body instanceof AST_EmptyStatement&&e.alternative&&e.alternative instanceof AST_SimpleStatement)return n(AST_SimpleStatement,e,{body:n(AST_Binary,e,{operator:"||",left:e.condition,right:e.alternative.body})}).transform(t);if(e.body instanceof AST_Exit&&e.alternative instanceof AST_Exit&&e.body.TYPE==e.alternative.TYPE)return n(e.body.CTOR,e,{value:n(AST_Conditional,e,{condition:e.condition,consequent:e.body.value||n(AST_Undefined,e.body).optimize(t),alternative:e.alternative.value||n(AST_Undefined,e.alternative).optimize(t)})}).transform(t);if(e.body instanceof AST_If&&!e.body.alternative&&!e.alternative&&(e.condition=n(AST_Binary,e.condition,{operator:"&&",left:e.condition,right:e.body.condition}).transform(t),e.body=e.body.body),u(e.body)&&e.alternative){var S=e.alternative;return e.alternative=null,n(AST_BlockStatement,e,{body:[e,S]}).transform(t)}if(u(e.alternative)){var p=e.body;return e.body=e.alternative,e.condition=l?a:e.condition.negate(t),e.alternative=null,n(AST_BlockStatement,e,{body:[e,p]}).transform(t)}return e}),e(AST_Switch,function(e,t){if(0==e.body.length&&t.option("conditionals"))return n(AST_SimpleStatement,e,{body:e.expression}).transform(t);for(;;){var r=e.body[e.body.length-1];if(r){var i=r.body[r.body.length-1];if(i instanceof AST_Break&&a(t.loopcontrol_target(i.label))===e&&r.body.pop(),r instanceof AST_Default&&0==r.body.length){e.body.pop();continue}}break}var o=e.expression.evaluate(t);e:if(2==o.length)try{if(e.expression=o[0],!t.option("dead_code"))break e;var s=o[1],f=!1,c=!1,l=!1,_=!1,S=!1,p=new TreeTransformer(function(r,i,o){if(r instanceof AST_Lambda||r instanceof AST_SimpleStatement)return r;if(r instanceof AST_Switch&&r===e)return r=r.clone(),i(r,this),S?r:n(AST_BlockStatement,r,{body:r.body.reduce(function(e,n){return e.concat(n.body)},[])}).transform(t);if(r instanceof AST_If||r instanceof AST_Try){var a=f;return f=!c,i(r,this),f=a,r}if(r instanceof AST_StatementWithBody||r instanceof AST_Switch){var a=c;return c=!0,i(r,this),c=a,r}if(r instanceof AST_Break&&this.loopcontrol_target(r.label)===e)return f?(S=!0,r):c?r:(_=!0,o?MAP.skip:n(AST_EmptyStatement,r));if(r instanceof AST_SwitchBranch&&this.parent()===e){if(_)return MAP.skip;if(r instanceof AST_Case){var p=r.expression.evaluate(t);if(p.length<2)throw e;return p[1]===s||l?(l=!0,u(r)&&(_=!0),i(r,this),r):MAP.skip}return i(r,this),r}});p.stack=t.stack.slice(),e=e.transform(p)}catch(d){if(d!==e)throw d}return e}),e(AST_Case,function(e,n){return e.body=s(e.body,n),e}),e(AST_Try,function(e,n){return e.body=s(e.body,n),e}),AST_Definitions.DEFMETHOD("remove_initializers",function(){this.definitions.forEach(function(e){e.value=null})}),AST_Definitions.DEFMETHOD("to_assignments",function(){var e=this.definitions.reduce(function(e,t){if(t.value){var r=n(AST_SymbolRef,t.name,t.name);e.push(n(AST_Assign,t,{operator:"=",left:r,right:t.value}))}return e},[]);return 0==e.length?null:AST_Seq.from_array(e)}),e(AST_Definitions,function(e,t){return 0==e.definitions.length?n(AST_EmptyStatement,e):e}),e(AST_Function,function(e,n){return e=AST_Lambda.prototype.optimize.call(e,n),n.option("unused")&&!n.option("keep_fnames")&&e.name&&e.name.unreferenced()&&(e.name=null),e}),e(AST_Call,function(e,r){if(r.option("unsafe")){var i=e.expression;if(i instanceof AST_SymbolRef&&i.undeclared())switch(i.name){case"Array":if(1!=e.args.length)return n(AST_Array,e,{elements:e.args}).transform(r);break;case"Object":if(0==e.args.length)return n(AST_Object,e,{properties:[]});break;case"String":if(0==e.args.length)return n(AST_String,e,{value:""});if(e.args.length<=1)return n(AST_Binary,e,{
left:e.args[0],operator:"+",right:n(AST_String,e,{value:""})}).transform(r);break;case"Number":if(0==e.args.length)return n(AST_Number,e,{value:0});if(1==e.args.length)return n(AST_UnaryPrefix,e,{expression:e.args[0],operator:"+"}).transform(r);case"Boolean":if(0==e.args.length)return n(AST_False,e);if(1==e.args.length)return n(AST_UnaryPrefix,e,{expression:n(AST_UnaryPrefix,null,{expression:e.args[0],operator:"!"}),operator:"!"}).transform(r);break;case"Function":if(0==e.args.length)return n(AST_Function,e,{argnames:[],body:[]});if(all(e.args,function(e){return e instanceof AST_String}))try{var o="(function("+e.args.slice(0,-1).map(function(e){return e.value}).join(",")+"){"+e.args[e.args.length-1].value+"})()",a=parse(o);a.figure_out_scope({screw_ie8:r.option("screw_ie8")});var s=new Compressor(r.options);a=a.transform(s),a.figure_out_scope({screw_ie8:r.option("screw_ie8")}),a.mangle_names();var f;try{a.walk(new TreeWalker(function(e){if(e instanceof AST_Lambda)throw f=e,a}))}catch(c){if(c!==a)throw c}if(!f)return e;var u=f.argnames.map(function(t,r){return n(AST_String,e.args[r],{value:t.print_to_string()})}),o=OutputStream();return AST_BlockStatement.prototype._codegen.call(f,f,o),o=o.toString().replace(/^\{|\}$/g,""),u.push(n(AST_String,e.args[e.args.length-1],{value:o})),e.args=u,e}catch(c){if(!(c instanceof JS_Parse_Error))throw console.log(c),c;r.warn("Error parsing code passed to new Function [{file}:{line},{col}]",e.args[e.args.length-1].start),r.warn(c.toString())}}else{if(i instanceof AST_Dot&&"toString"==i.property&&0==e.args.length)return n(AST_Binary,e,{left:n(AST_String,e,{value:""}),operator:"+",right:i.expression}).transform(r);if(i instanceof AST_Dot&&i.expression instanceof AST_Array&&"join"==i.property){var _=0==e.args.length?",":e.args[0].evaluate(r)[1];if(null!=_){var S=i.expression.elements.reduce(function(e,n){if(n=n.evaluate(r),0==e.length||1==n.length)e.push(n);else{var i=e[e.length-1];if(2==i.length){var o=""+i[1]+_+n[1];e[e.length-1]=[t(r,o,i[0]),o]}else e.push(n)}return e},[]);if(0==S.length)return n(AST_String,e,{value:""});if(1==S.length)return S[0][0];if(""==_){var p;return p=S[0][0]instanceof AST_String||S[1][0]instanceof AST_String?S.shift()[0]:n(AST_String,e,{value:""}),S.reduce(function(e,t){return n(AST_Binary,t[0],{operator:"+",left:e,right:t[0]})},p).transform(r)}var d=e.clone();return d.expression=d.expression.clone(),d.expression.expression=d.expression.expression.clone(),d.expression.expression.elements=S.map(function(e){return e[0]}),l(e,d)}}}}if(r.option("side_effects")&&e.expression instanceof AST_Function&&0==e.args.length&&!AST_Block.prototype.has_side_effects.call(e.expression,r))return n(AST_Undefined,e).transform(r);if(r.option("drop_console")&&e.expression instanceof AST_PropAccess){for(var T=e.expression.expression;T.expression;)T=T.expression;if(T instanceof AST_SymbolRef&&"console"==T.name&&T.undeclared())return n(AST_Undefined,e).transform(r)}return e.evaluate(r)[0]}),e(AST_New,function(e,t){if(t.option("unsafe")){var r=e.expression;if(r instanceof AST_SymbolRef&&r.undeclared())switch(r.name){case"Object":case"RegExp":case"Function":case"Error":case"Array":return n(AST_Call,e,e).transform(t)}}return e}),e(AST_Seq,function(e,t){if(!t.option("side_effects"))return e;if(!e.car.has_side_effects(t))return r(t.parent(),e,e.cdr);if(t.option("cascade")){if(e.car instanceof AST_Assign&&!e.car.left.has_side_effects(t)){if(e.car.left.equivalent_to(e.cdr))return e.car;if(e.cdr instanceof AST_Call&&e.cdr.expression.equivalent_to(e.car.left))return e.cdr.expression=e.car,e.cdr}if(!e.car.has_side_effects(t)&&!e.cdr.has_side_effects(t)&&e.car.equivalent_to(e.cdr))return e.car}return e.cdr instanceof AST_UnaryPrefix&&"void"==e.cdr.operator&&!e.cdr.expression.has_side_effects(t)?(e.cdr.expression=e.car,e.cdr):e.cdr instanceof AST_Undefined?n(AST_UnaryPrefix,e,{operator:"void",expression:e.car}):e}),AST_Unary.DEFMETHOD("lift_sequences",function(e){if(e.option("sequences")&&this.expression instanceof AST_Seq){var n=this.expression,t=n.to_array();return this.expression=t.pop(),t.push(this),n=AST_Seq.from_array(t).transform(e)}return this}),e(AST_UnaryPostfix,function(e,n){return e.lift_sequences(n)}),e(AST_UnaryPrefix,function(e,t){e=e.lift_sequences(t);var r=e.expression;if(t.option("booleans")&&t.in_boolean_context()){switch(e.operator){case"!":if(r instanceof AST_UnaryPrefix&&"!"==r.operator)return r.expression;break;case"typeof":return t.warn("Boolean expression always true [{file}:{line},{col}]",e.start),n(AST_True,e)}r instanceof AST_Binary&&"!"==e.operator&&(e=l(e,r.negate(t)))}return e.evaluate(t)[0]}),AST_Binary.DEFMETHOD("lift_sequences",function(e){if(e.option("sequences")){if(this.left instanceof AST_Seq){var n=this.left,t=n.to_array();return this.left=t.pop(),t.push(this),n=AST_Seq.from_array(t).transform(e)}if(this.right instanceof AST_Seq&&this instanceof AST_Assign&&!S(this.left,e)){var n=this.right,t=n.to_array();return this.right=t.pop(),t.push(this),n=AST_Seq.from_array(t).transform(e)}}return this});var d=makePredicate("== === != !== * & | ^");e(AST_Binary,function(e,t){function i(n,r){if(r||!e.left.has_side_effects(t)&&!e.right.has_side_effects(t)){n&&(e.operator=n);var i=e.left;e.left=e.right,e.right=i}}if(d(e.operator)&&(e.right instanceof AST_Constant&&!(e.left instanceof AST_Constant)&&(e.left instanceof AST_Binary&&PRECEDENCE[e.left.operator]>=PRECEDENCE[e.operator]||i(null,!0)),/^[!=]==?$/.test(e.operator))){if(e.left instanceof AST_SymbolRef&&e.right instanceof AST_Conditional){if(e.right.consequent instanceof AST_SymbolRef&&e.right.consequent.definition()===e.left.definition()){if(/^==/.test(e.operator))return e.right.condition;if(/^!=/.test(e.operator))return e.right.condition.negate(t)}if(e.right.alternative instanceof AST_SymbolRef&&e.right.alternative.definition()===e.left.definition()){if(/^==/.test(e.operator))return e.right.condition.negate(t);if(/^!=/.test(e.operator))return e.right.condition}}if(e.right instanceof AST_SymbolRef&&e.left instanceof AST_Conditional){if(e.left.consequent instanceof AST_SymbolRef&&e.left.consequent.definition()===e.right.definition()){if(/^==/.test(e.operator))return e.left.condition;if(/^!=/.test(e.operator))return e.left.condition.negate(t)}if(e.left.alternative instanceof AST_SymbolRef&&e.left.alternative.definition()===e.right.definition()){if(/^==/.test(e.operator))return e.left.condition.negate(t);if(/^!=/.test(e.operator))return e.left.condition}}}if(e=e.lift_sequences(t),t.option("comparisons"))switch(e.operator){case"===":case"!==":(e.left.is_string(t)&&e.right.is_string(t)||e.left.is_boolean()&&e.right.is_boolean())&&(e.operator=e.operator.substr(0,2));case"==":case"!=":e.left instanceof AST_String&&"undefined"==e.left.value&&e.right instanceof AST_UnaryPrefix&&"typeof"==e.right.operator&&t.option("unsafe")&&(e.right.expression instanceof AST_SymbolRef&&e.right.expression.undeclared()||(e.right=e.right.expression,e.left=n(AST_Undefined,e.left).optimize(t),2==e.operator.length&&(e.operator+="=")))}if(t.option("conditionals"))if("&&"==e.operator){var o=e.left.evaluate(t);if(o.length>1)return o[1]?(t.warn("Condition left of && always true [{file}:{line},{col}]",e.start),r(t.parent(),e,e.right.evaluate(t)[0])):(t.warn("Condition left of && always false [{file}:{line},{col}]",e.start),r(t.parent(),e,o[0]))}else if("||"==e.operator){var o=e.left.evaluate(t);if(o.length>1)return o[1]?(t.warn("Condition left of || always true [{file}:{line},{col}]",e.start),r(t.parent(),e,o[0])):(t.warn("Condition left of || always false [{file}:{line},{col}]",e.start),r(t.parent(),e,e.right.evaluate(t)[0]))}if(t.option("booleans")&&t.in_boolean_context())switch(e.operator){case"&&":var o=e.left.evaluate(t),a=e.right.evaluate(t);if(o.length>1&&!o[1]||a.length>1&&!a[1])return t.warn("Boolean && always false [{file}:{line},{col}]",e.start),e.left.has_side_effects(t)?n(AST_Seq,e,{car:e.left,cdr:n(AST_False)}).optimize(t):n(AST_False,e);if(o.length>1&&o[1])return a[0];if(a.length>1&&a[1])return o[0];break;case"||":var o=e.left.evaluate(t),a=e.right.evaluate(t);if(o.length>1&&o[1]||a.length>1&&a[1])return t.warn("Boolean || always true [{file}:{line},{col}]",e.start),e.left.has_side_effects(t)?n(AST_Seq,e,{car:e.left,cdr:n(AST_True)}).optimize(t):n(AST_True,e);if(o.length>1&&!o[1])return a[0];if(a.length>1&&!a[1])return o[0];break;case"+":var o=e.left.evaluate(t),a=e.right.evaluate(t);if(o.length>1&&o[0]instanceof AST_String&&o[1]||a.length>1&&a[0]instanceof AST_String&&a[1])return t.warn("+ in boolean context always true [{file}:{line},{col}]",e.start),n(AST_True,e)}if(t.option("comparisons")&&e.is_boolean()){if(!(t.parent()instanceof AST_Binary)||t.parent()instanceof AST_Assign){var s=n(AST_UnaryPrefix,e,{operator:"!",expression:e.negate(t)});e=l(e,s)}if(t.option("unsafe_comps"))switch(e.operator){case"<":i(">");break;case"<=":i(">=")}}return"+"==e.operator&&e.right instanceof AST_String&&""===e.right.getValue()&&e.left instanceof AST_Binary&&"+"==e.left.operator&&e.left.is_string(t)?e.left:(t.option("evaluate")&&"+"==e.operator&&(e.left instanceof AST_Constant&&e.right instanceof AST_Binary&&"+"==e.right.operator&&e.right.left instanceof AST_Constant&&e.right.is_string(t)&&(e=n(AST_Binary,e,{operator:"+",left:n(AST_String,null,{value:""+e.left.getValue()+e.right.left.getValue(),start:e.left.start,end:e.right.left.end}),right:e.right.right})),e.right instanceof AST_Constant&&e.left instanceof AST_Binary&&"+"==e.left.operator&&e.left.right instanceof AST_Constant&&e.left.is_string(t)&&(e=n(AST_Binary,e,{operator:"+",left:e.left.left,right:n(AST_String,null,{value:""+e.left.right.getValue()+e.right.getValue(),start:e.left.right.start,end:e.right.end})})),e.left instanceof AST_Binary&&"+"==e.left.operator&&e.left.is_string(t)&&e.left.right instanceof AST_Constant&&e.right instanceof AST_Binary&&"+"==e.right.operator&&e.right.left instanceof AST_Constant&&e.right.is_string(t)&&(e=n(AST_Binary,e,{operator:"+",left:n(AST_Binary,e.left,{operator:"+",left:e.left.left,right:n(AST_String,null,{value:""+e.left.right.getValue()+e.right.left.getValue(),start:e.left.right.start,end:e.right.left.end})}),right:e.right.right}))),e.right instanceof AST_Binary&&e.right.operator==e.operator&&("&&"==e.operator||"||"==e.operator)?(e.left=n(AST_Binary,e.left,{operator:e.operator,left:e.left,right:e.right.left}),e.right=e.right.right,e.transform(t)):e.evaluate(t)[0])}),e(AST_SymbolRef,function(e,r){function i(e,n){return n instanceof AST_Binary&&"="===n.operator&&n.left===e}if(e.undeclared()&&!i(e,r.parent())){var o=r.option("global_defs");if(o&&HOP(o,e.name))return t(r,o[e.name],e);if(!e.scope.uses_with||!r.find_parent(AST_With))switch(e.name){case"undefined":return n(AST_Undefined,e);case"NaN":return n(AST_NaN,e).transform(r);case"Infinity":return n(AST_Infinity,e).transform(r)}}return e}),e(AST_Infinity,function(e,t){return n(AST_Binary,e,{operator:"/",left:n(AST_Number,e,{value:1}),right:n(AST_Number,e,{value:0})})}),e(AST_Undefined,function(e,t){if(t.option("unsafe")){var r=t.find_parent(AST_Scope),i=r.find_variable("undefined");if(i){var o=n(AST_SymbolRef,e,{name:"undefined",scope:r,thedef:i});return o.reference(),o}}return e});var T=["+","-","/","*","%",">>","<<",">>>","|","^","&"];e(AST_Assign,function(e,n){return e=e.lift_sequences(n),"="==e.operator&&e.left instanceof AST_SymbolRef&&e.right instanceof AST_Binary&&e.right.left instanceof AST_SymbolRef&&e.right.left.name==e.left.name&&member(e.right.operator,T)&&(e.operator=e.right.operator+"=",e.right=e.right.right),e}),e(AST_Conditional,function(e,i){function o(e){return e.is_boolean()?e:n(AST_UnaryPrefix,e,{operator:"!",expression:e.negate(i)})}function a(e){return e instanceof AST_True||e instanceof AST_UnaryPrefix&&"!"==e.operator&&e.expression instanceof AST_Constant&&!e.expression.value}function s(e){return e instanceof AST_False||e instanceof AST_UnaryPrefix&&"!"==e.operator&&e.expression instanceof AST_Constant&&!!e.expression.value}if(!i.option("conditionals"))return e;if(e.condition instanceof AST_Seq){var f=e.condition.car;return e.condition=e.condition.cdr,AST_Seq.cons(f,e)}var c=e.condition.evaluate(i);if(c.length>1)return c[1]?(i.warn("Condition always true [{file}:{line},{col}]",e.start),r(i.parent(),e,e.consequent)):(i.warn("Condition always false [{file}:{line},{col}]",e.start),r(i.parent(),e,e.alternative));var u=c[0].negate(i);l(c[0],u)===u&&(e=n(AST_Conditional,e,{condition:u,consequent:e.alternative,alternative:e.consequent}));var _=e.consequent,S=e.alternative;if(_ instanceof AST_Assign&&S instanceof AST_Assign&&_.operator==S.operator&&_.left.equivalent_to(S.left)&&!_.left.has_side_effects(i))return n(AST_Assign,e,{operator:_.operator,left:_.left,right:n(AST_Conditional,e,{condition:e.condition,consequent:_.right,alternative:S.right})});if(_ instanceof AST_Call&&S.TYPE===_.TYPE&&_.args.length==S.args.length&&!_.expression.has_side_effects(i)&&_.expression.equivalent_to(S.expression)){if(0==_.args.length)return n(AST_Seq,e,{car:e.condition,cdr:_});if(1==_.args.length)return _.args[0]=n(AST_Conditional,e,{condition:e.condition,consequent:_.args[0],alternative:S.args[0]}),_}if(_ instanceof AST_Conditional&&_.alternative.equivalent_to(S))return n(AST_Conditional,e,{condition:n(AST_Binary,e,{left:e.condition,operator:"&&",right:_.condition}),consequent:_.consequent,alternative:S});if(_.is_constant(i)&&S.is_constant(i)&&_.equivalent_to(S)){var p=_.constant_value(i);return e.condition.has_side_effects(i)?AST_Seq.from_array([e.condition,t(i,p,e)]):t(i,p,e)}return a(e.consequent)?s(e.alternative)?o(e.condition):n(AST_Binary,e,{operator:"||",left:o(e.condition),right:e.alternative}):s(e.consequent)?a(e.alternative)?o(e.condition.negate(i)):n(AST_Binary,e,{operator:"&&",left:o(e.condition.negate(i)),right:e.alternative}):a(e.alternative)?n(AST_Binary,e,{operator:"||",left:o(e.condition.negate(i)),right:e.consequent}):s(e.alternative)?n(AST_Binary,e,{operator:"&&",left:o(e.condition),right:e.consequent}):e}),e(AST_Boolean,function(e,t){if(t.option("booleans")){var r=t.parent();return r instanceof AST_Binary&&("=="==r.operator||"!="==r.operator)?(t.warn("Non-strict equality against boolean: {operator} {value} [{file}:{line},{col}]",{operator:r.operator,value:e.value,file:r.start.file,line:r.start.line,col:r.start.col}),n(AST_Number,e,{value:+e.value})):n(AST_UnaryPrefix,e,{operator:"!",expression:n(AST_Number,e,{value:1-e.value})})}return e}),e(AST_Sub,function(e,t){var r=e.property;if(r instanceof AST_String&&t.option("properties")){if(r=r.getValue(),RESERVED_WORDS(r)?t.option("screw_ie8"):is_identifier_string(r))return n(AST_Dot,e,{expression:e.expression,property:r}).optimize(t);var i=parseFloat(r);isNaN(i)||i.toString()!=r||(e.property=n(AST_Number,e.property,{value:i}))}return e}),e(AST_Dot,function(e,t){var r=e.property;return RESERVED_WORDS(r)&&!t.option("screw_ie8")?n(AST_Sub,e,{expression:e.expression,property:n(AST_String,e,{value:r})}).optimize(t):e.evaluate(t)[0]}),e(AST_Array,p),e(AST_Object,p),e(AST_RegExp,p),e(AST_Return,function(e,n){return e.value instanceof AST_Undefined&&(e.value=null),e})}();