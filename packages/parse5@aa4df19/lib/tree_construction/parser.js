"use strict";function getSearchableIndexFormAttrs(e){var t=Tokenizer.getTokenAttr(e,ATTRS.ACTION),n=[];return null!==t&&n.push({name:ATTRS.ACTION,value:t}),n}function getSearchableIndexLabelText(e){var t=Tokenizer.getTokenAttr(e,ATTRS.PROMPT);return null===t?SEARCHABLE_INDEX_DEFAULT_PROMPT:t}function getSearchableIndexInputAttrs(e){for(var t=e.attrs,n=[],T=0;T<t.length;T++){var r=t[T].name;r!==ATTRS.NAME&&r!==ATTRS.ACTION&&r!==ATTRS.PROMPT&&n.push(t[T])}return n.push({name:ATTRS.NAME,value:SEARCHABLE_INDEX_INPUT_NAME}),n}function ignoreToken(e,t){}function appendComment(e,t){e._appendCommentNode(t,e.openElements.current)}function appendCommentToRootHtmlElement(e,t){e._appendCommentNode(t,e.openElements.items[0])}function appendCommentToDocument(e,t){e._appendCommentNode(t,e.document)}function insertCharacters(e,t){e._insertCharacters(t)}function stopParsing(e,t){e.stopped=!0}function doctypeInInitialMode(e,t){e._setDocumentType(t),(t.forceQuirks||Doctype.isQuirks(t.name,t.publicId,t.systemId))&&e.treeAdapter.setQuirksMode(e.document),e.insertionMode=BEFORE_HTML_MODE}function tokenInInitialMode(e,t){e.treeAdapter.setQuirksMode(e.document),e.insertionMode=BEFORE_HTML_MODE,e._processToken(t)}function startTagBeforeHtml(e,t){t.tagName===$.HTML?(e._insertElement(t,NS.HTML),e.insertionMode=BEFORE_HEAD_MODE):tokenBeforeHtml(e,t)}function endTagBeforeHtml(e,t){var n=t.tagName;n!==$.HTML&&n!==$.HEAD&&n!==$.BODY&&n!==$.BR||tokenBeforeHtml(e,t)}function tokenBeforeHtml(e,t){e._insertFakeRootElement(),e.insertionMode=BEFORE_HEAD_MODE,e._processToken(t)}function startTagBeforeHead(e,t){var n=t.tagName;n===$.HTML?startTagInBody(e,t):n===$.HEAD?(e._insertElement(t,NS.HTML),e.headElement=e.openElements.current,e.insertionMode=IN_HEAD_MODE):tokenBeforeHead(e,t)}function endTagBeforeHead(e,t){var n=t.tagName;n!==$.HEAD&&n!==$.BODY&&n!==$.HTML&&n!==$.BR||tokenBeforeHead(e,t)}function tokenBeforeHead(e,t){e._processFakeStartTag($.HEAD),e._processToken(t)}function startTagInHead(e,t){var n=t.tagName;n===$.HTML?startTagInBody(e,t):n===$.BASE||n===$.BASEFONT||n===$.BGSOUND||n===$.COMMAND||n===$.LINK||n===$.META?e._appendElement(t,NS.HTML):n===$.TITLE?e._switchToTextParsing(t,Tokenizer.RCDATA_STATE):n===$.NOSCRIPT||n===$.NOFRAMES||n===$.STYLE?e._switchToTextParsing(t,Tokenizer.RAWTEXT_STATE):n===$.SCRIPT?(e._insertElement(t,NS.HTML),e.tokenizer.state=Tokenizer.SCRIPT_DATA_STATE,e.originalInsertionMode=e.insertionMode,e.insertionMode=TEXT_MODE):n!==$.HEAD&&tokenInHead(e,t)}function endTagInHead(e,t){var n=t.tagName;n===$.HEAD?(e.openElements.pop(),e.insertionMode=AFTER_HEAD_MODE):n!==$.BODY&&n!==$.BR&&n!==$.HTML||tokenInHead(e,t)}function tokenInHead(e,t){e._processFakeEndTag($.HEAD),e._processToken(t)}function startTagAfterHead(e,t){var n=t.tagName;n===$.HTML?startTagInBody(e,t):n===$.BODY?(e._insertElement(t,NS.HTML),e.framesetOk=!1,e.insertionMode=IN_BODY_MODE):n===$.FRAMESET?(e._insertElement(t,NS.HTML),e.insertionMode=IN_FRAMESET_MODE):n===$.BASE||n===$.BASEFONT||n===$.BGSOUND||n===$.LINK||n===$.META||n===$.NOFRAMES||n===$.SCRIPT||n===$.STYLE||n===$.TITLE?(e.openElements.push(e.headElement),startTagInHead(e,t),e.openElements.remove(e.headElement)):n!==$.HEAD&&tokenAfterHead(e,t)}function endTagAfterHead(e,t){var n=t.tagName;n!==$.BODY&&n!==$.HTML&&n!==$.BR||tokenAfterHead(e,t)}function tokenAfterHead(e,t){e._processFakeStartTag($.BODY),e.framesetOk=!0,e._processToken(t)}function whitespaceCharacterInBody(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function characterInBody(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function htmlStartTagInBody(e,t){e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function bodyStartTagInBody(e,t){var n=e.openElements.tryPeekProperlyNestedBodyElement();n&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(n,t.attrs))}function framesetStartTagInBody(e,t){var n=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&n&&(e.treeAdapter.detachNode(n),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,NS.HTML),e.insertionMode=IN_FRAMESET_MODE)}function addressStartTagInBody(e,t){e.openElements.hasInButtonScope($.P)&&e._closePElement(),e._insertElement(t,NS.HTML)}function numberedHeaderStartTagInBody(e,t){e.openElements.hasInButtonScope($.P)&&e._closePElement();var n=e.openElements.currentTagName;n!==$.H1&&n!==$.H2&&n!==$.H3&&n!==$.H4&&n!==$.H5&&n!==$.H6||e.openElements.pop(),e._insertElement(t,NS.HTML)}function preStartTagInBody(e,t){e.openElements.hasInButtonScope($.P)&&e._closePElement(),e._insertElement(t,NS.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function formStartTagInBody(e,t){e.formElement||(e.openElements.hasInButtonScope($.P)&&e._closePElement(),e._insertElement(t,NS.HTML),e.formElement=e.openElements.current)}function listItemStartTagInBody(e,t){e.framesetOk=!1;for(var n=e.openElements.stackTop;n>=0;n--){var T=e.openElements.items[n],r=e.treeAdapter.getTagName(T);if(t.tagName===$.LI&&r===$.LI||(t.tagName===$.DD||t.tagName===$.DT)&&(r===$.DD||r==$.DT)){e._processFakeEndTag(r);break}if(r!==$.ADDRESS&&r!==$.DIV&&r!==$.P&&e._isSpecialElement(T))break}e.openElements.hasInButtonScope($.P)&&e._closePElement(),e._insertElement(t,NS.HTML)}function plaintextStartTagInBody(e,t){e.openElements.hasInButtonScope($.P)&&e._closePElement(),e._insertElement(t,NS.HTML),e.tokenizer.state=Tokenizer.PLAINTEXT_STATE}function buttonStartTagInBody(e,t){e.openElements.hasInScope($.BUTTON)?(e._processFakeEndTag($.BUTTON),buttonStartTagInBody(e,t)):(e._reconstructActiveFormattingElements(),e._insertElement(t,NS.HTML),e.framesetOk=!1)}function aStartTagInBody(e,t){var n=e.activeFormattingElements.getElementEntryInScopeWithTagName($.A);n&&(e._processFakeEndTag($.A),e.openElements.remove(n.element),e.activeFormattingElements.removeEntry(n)),e._reconstructActiveFormattingElements(),e._insertElement(t,NS.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function bStartTagInBody(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,NS.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function nobrStartTagInBody(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope($.NOBR)&&(e._processFakeEndTag($.NOBR),e._reconstructActiveFormattingElements()),e._insertElement(t,NS.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function appletStartTagInBody(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,NS.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function tableStartTagInBody(e,t){!e.treeAdapter.isQuirksMode(e.document)&&e.openElements.hasInButtonScope($.P)&&e._closePElement(),e._insertElement(t,NS.HTML),e.framesetOk=!1,e.insertionMode=IN_TABLE_MODE}function areaStartTagInBody(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,NS.HTML),e.framesetOk=!1}function inputStartTagInBody(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,NS.HTML);var n=Tokenizer.getTokenAttr(t,ATTRS.TYPE);n&&n.toLowerCase()===HIDDEN_INPUT_TYPE||(e.framesetOk=!1)}function paramStartTagInBody(e,t){e._appendElement(t,NS.HTML)}function hrStartTagInBody(e,t){e.openElements.hasInButtonScope($.P)&&e._closePElement(),e._appendElement(t,NS.HTML),e.framesetOk=!1}function imageStartTagInBody(e,t){t.tagName=$.IMG,areaStartTagInBody(e,t)}function isindexStartTagInBody(e,t){e.formElement||(e._processFakeStartTagWithAttrs($.FORM,getSearchableIndexFormAttrs(t)),e._processFakeStartTag($.HR),e._processFakeStartTag($.LABEL),e.treeAdapter.insertText(e.openElements.current,getSearchableIndexLabelText(t)),e._processFakeStartTagWithAttrs($.INPUT,getSearchableIndexInputAttrs(t)),e._processFakeEndTag($.LABEL),e._processFakeStartTag($.HR),e._processFakeEndTag($.FORM))}function textareaStartTagInBody(e,t){e._insertElement(t,NS.HTML),e.skipNextNewLine=!0,e.tokenizer.state=Tokenizer.RCDATA_STATE,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=TEXT_MODE}function xmpStartTagInBody(e,t){e.openElements.hasInButtonScope($.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,Tokenizer.RAWTEXT_STATE)}function iframeStartTagInBody(e,t){e.framesetOk=!1,e._switchToTextParsing(t,Tokenizer.RAWTEXT_STATE)}function noembedStartTagInBody(e,t){e._switchToTextParsing(t,Tokenizer.RAWTEXT_STATE)}function selectStartTagInBody(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,NS.HTML),e.framesetOk=!1,e.insertionMode===IN_TABLE_MODE||e.insertionMode===IN_CAPTION_MODE||e.insertionMode===IN_TABLE_BODY_MODE||e.insertionMode===IN_ROW_MODE||e.insertionMode===IN_CELL_MODE?e.insertionMode=IN_SELECT_IN_TABLE_MODE:e.insertionMode=IN_SELECT_MODE}function optgroupStartTagInBody(e,t){e.openElements.currentTagName===$.OPTION&&e._processFakeEndTag($.OPTION),e._reconstructActiveFormattingElements(),e._insertElement(t,NS.HTML)}function rpStartTagInBody(e,t){e.openElements.hasInScope($.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,NS.HTML)}function menuitemStartTagInBody(e,t){e._appendElement(t,NS.HTML)}function mathStartTagInBody(e,t){e._reconstructActiveFormattingElements(),ForeignContent.adjustTokenMathMLAttrs(t),ForeignContent.adjustTokenXMLAttrs(t),t.selfClosing?e._appendElement(t,NS.MATHML):e._insertElement(t,NS.MATHML)}function svgStartTagInBody(e,t){e._reconstructActiveFormattingElements(),ForeignContent.adjustTokenSVGAttrs(t),ForeignContent.adjustTokenXMLAttrs(t),t.selfClosing?e._appendElement(t,NS.SVG):e._insertElement(t,NS.SVG)}function genericStartTagInBody(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,NS.HTML)}function startTagInBody(e,t){var n=t.tagName;switch(n.length){case 1:n===$.I||n===$.S||n===$.B||n===$.U?bStartTagInBody(e,t):n===$.P?addressStartTagInBody(e,t):n===$.A?aStartTagInBody(e,t):genericStartTagInBody(e,t);break;case 2:n===$.DL||n===$.OL||n===$.UL?addressStartTagInBody(e,t):n===$.H1||n===$.H2||n===$.H3||n===$.H4||n===$.H5||n===$.H6?numberedHeaderStartTagInBody(e,t):n===$.LI||n===$.DD||n===$.DT?listItemStartTagInBody(e,t):n===$.EM||n===$.TT?bStartTagInBody(e,t):n===$.BR?areaStartTagInBody(e,t):n===$.HR?hrStartTagInBody(e,t):n===$.RP||n===$.RT?rpStartTagInBody(e,t):n!==$.TH&&n!==$.TD&&n!==$.TR&&genericStartTagInBody(e,t);break;case 3:n===$.DIV||n===$.DIR||n===$.NAV?addressStartTagInBody(e,t):n===$.PRE?preStartTagInBody(e,t):n===$.BIG?bStartTagInBody(e,t):n===$.IMG||n===$.WBR?areaStartTagInBody(e,t):n===$.XMP?xmpStartTagInBody(e,t):n===$.SVG?svgStartTagInBody(e,t):n!==$.COL&&genericStartTagInBody(e,t);break;case 4:n===$.HTML?htmlStartTagInBody(e,t):n===$.BASE||n===$.LINK||n===$.META?startTagInHead(e,t):n===$.BODY?bodyStartTagInBody(e,t):n===$.MAIN||n===$.MENU?addressStartTagInBody(e,t):n===$.FORM?formStartTagInBody(e,t):n===$.CODE||n===$.FONT?bStartTagInBody(e,t):n===$.NOBR?nobrStartTagInBody(e,t):n===$.AREA?areaStartTagInBody(e,t):n===$.MATH?mathStartTagInBody(e,t):n!==$.HEAD&&genericStartTagInBody(e,t);break;case 5:n===$.STYLE||n===$.TITLE?startTagInHead(e,t):n===$.ASIDE?addressStartTagInBody(e,t):n===$.SMALL?bStartTagInBody(e,t):n===$.TABLE?tableStartTagInBody(e,t):n===$.EMBED?areaStartTagInBody(e,t):n===$.INPUT?inputStartTagInBody(e,t):n===$.PARAM||n===$.TRACK?paramStartTagInBody(e,t):n===$.IMAGE?imageStartTagInBody(e,t):n!==$.FRAME&&n!==$.TBODY&&n!==$.TFOOT&&n!==$.THEAD&&genericStartTagInBody(e,t);break;case 6:n===$.SCRIPT?startTagInHead(e,t):n===$.CENTER||n===$.FIGURE||n===$.FOOTER||n===$.HEADER||n===$.HGROUP?addressStartTagInBody(e,t):n===$.BUTTON?buttonStartTagInBody(e,t):n===$.STRIKE||n===$.STRONG?bStartTagInBody(e,t):n===$.APPLET||n===$.OBJECT?appletStartTagInBody(e,t):n===$.KEYGEN?areaStartTagInBody(e,t):n===$.SOURCE?paramStartTagInBody(e,t):n===$.IFRAME?iframeStartTagInBody(e,t):n===$.SELECT?selectStartTagInBody(e,t):n===$.OPTION?optgroupStartTagInBody(e,t):genericStartTagInBody(e,t);break;case 7:n===$.BGSOUND||n===$.COMMAND?startTagInHead(e,t):n===$.DETAILS||n===$.ADDRESS||n===$.ARTICLE||n===$.SECTION||n===$.SUMMARY?addressStartTagInBody(e,t):n===$.LISTING?preStartTagInBody(e,t):n===$.MARQUEE?appletStartTagInBody(e,t):n===$.ISINDEX?isindexStartTagInBody(e,t):n===$.NOEMBED?noembedStartTagInBody(e,t):n!==$.CAPTION&&genericStartTagInBody(e,t);break;case 8:n===$.BASEFONT||n===$.MENUITEM?menuitemStartTagInBody(e,t):n===$.FRAMESET?framesetStartTagInBody(e,t):n===$.FIELDSET?addressStartTagInBody(e,t):n===$.TEXTAREA?textareaStartTagInBody(e,t):n===$.NOSCRIPT?noembedStartTagInBody(e,t):n===$.OPTGROUP?optgroupStartTagInBody(e,t):n!==$.COLGROUP&&genericStartTagInBody(e,t);break;case 9:n===$.PLAINTEXT?plaintextStartTagInBody(e,t):genericStartTagInBody(e,t);break;case 10:n===$.BLOCKQUOTE||n===$.FIGCAPTION?addressStartTagInBody(e,t):genericStartTagInBody(e,t);break;default:genericStartTagInBody(e,t)}}function bodyEndTagInBody(e,t){e.openElements.hasInScope($.BODY)?e.insertionMode=AFTER_BODY_MODE:t.ignored=!0}function htmlEndTagInBody(e,t){var n=e._processFakeEndTag($.BODY);n.ignored||e._processToken(t)}function addressEndTagInBody(e,t){var n=t.tagName;e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n))}function formEndTagInBody(e,t){var n=e.formElement;e.formElement=null,n&&e.openElements.hasInScope($.FORM)&&(e.openElements.generateImpliedEndTags(),e.openElements.remove(n))}function pEndTagInBody(e,t){e.openElements.hasInButtonScope($.P)?(e.openElements.generateImpliedEndTagsWithExclusion($.P),e.openElements.popUntilTagNamePopped($.P)):(e._processFakeStartTag($.P),e._processToken(t))}function liEndTagInBody(e,t){e.openElements.hasInListItemScope($.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion($.LI),e.openElements.popUntilTagNamePopped($.LI))}function ddEndTagInBody(e,t){var n=t.tagName;e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.popUntilTagNamePopped(n))}function numberedHeaderEndTagInBody(e,t){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function appletEndTagInBody(e,t){var n=t.tagName;e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n),e.activeFormattingElements.clearToLastMarker())}function brEndTagInBody(e,t){e._processFakeStartTag($.BR)}function genericEndTagInBody(e,t){for(var n=t.tagName,T=e.openElements.stackTop;T>0;T--){var r=e.openElements.items[T];if(e.treeAdapter.getTagName(r)===n){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.popUntilElementPopped(r);break}if(e._isSpecialElement(r))break}}function endTagInBody(e,t){var n=t.tagName;switch(n.length){case 1:n===$.A||n===$.B||n===$.I||n===$.S||n==$.U?e._callAdoptionAgency(t):n===$.P?pEndTagInBody(e,t):genericEndTagInBody(e,t);break;case 2:n==$.DL||n===$.UL||n===$.OL?addressEndTagInBody(e,t):n===$.LI?liEndTagInBody(e,t):n===$.DD||n===$.DT?ddEndTagInBody(e,t):n===$.H1||n===$.H2||n===$.H3||n===$.H4||n===$.H5||n===$.H6?numberedHeaderEndTagInBody(e,t):n===$.BR?brEndTagInBody(e,t):n===$.EM||n===$.TT?e._callAdoptionAgency(t):genericEndTagInBody(e,t);break;case 3:n===$.BIG?e._callAdoptionAgency(t):n===$.DIR||n===$.DIV||n===$.NAV?addressEndTagInBody(e,t):genericEndTagInBody(e,t);break;case 4:n===$.BODY?bodyEndTagInBody(e,t):n===$.HTML?htmlEndTagInBody(e,t):n===$.FORM?formEndTagInBody(e,t):n===$.CODE||n===$.FONT||n===$.NOBR?e._callAdoptionAgency(t):n===$.MAIN||n===$.MENU?addressEndTagInBody(e,t):genericEndTagInBody(e,t);break;case 5:n===$.ASIDE?addressEndTagInBody(e,t):n===$.SMALL?e._callAdoptionAgency(t):genericEndTagInBody(e,t);break;case 6:n===$.CENTER||n===$.FIGURE||n===$.FOOTER||n===$.HEADER||n===$.HGROUP?addressEndTagInBody(e,t):n===$.APPLET||n===$.OBJECT?appletEndTagInBody(e,t):n==$.STRIKE||n===$.STRONG?e._callAdoptionAgency(t):genericEndTagInBody(e,t);break;case 7:n===$.ADDRESS||n===$.ARTICLE||n===$.DETAILS||n===$.SECTION||n===$.SUMMARY?addressEndTagInBody(e,t):n===$.MARQUEE?appletEndTagInBody(e,t):genericEndTagInBody(e,t);break;case 8:n===$.FIELDSET?addressEndTagInBody(e,t):genericEndTagInBody(e,t);break;case 10:n===$.BLOCKQUOTE||n===$.FIGCAPTION?addressEndTagInBody(e,t):genericEndTagInBody(e,t);break;default:genericEndTagInBody(e,t)}}function endTagInText(e,t){!e.fragmentContext&&e.scriptHandler&&t.tagName===$.SCRIPT&&e.scriptHandler(e.document,e.openElements.current),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function eofInText(e,t){e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e._processToken(t)}function characterInTable(e,t){var n=e.openElements.currentTagName;n===$.TABLE||n===$.TBODY||n===$.TFOOT||n===$.THEAD||n===$.TR?(e.pendingCharacterTokens=[],e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=IN_TABLE_TEXT_MODE,e._processToken(t)):tokenInTable(e,t)}function captionStartTagInTable(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,NS.HTML),e.insertionMode=IN_CAPTION_MODE}function colgroupStartTagInTable(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,NS.HTML),e.insertionMode=IN_COLUMN_GROUP_MODE}function colStartTagInTable(e,t){e._processFakeStartTag($.COLGROUP),e._processToken(t)}function tbodyStartTagInTable(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,NS.HTML),e.insertionMode=IN_TABLE_BODY_MODE}function tdStartTagInTable(e,t){e._processFakeStartTag($.TBODY),e._processToken(t)}function tableStartTagInTable(e,t){var n=e._processFakeEndTag($.TABLE);n.ignored||e._processToken(t)}function inputStartTagInTable(e,t){var n=Tokenizer.getTokenAttr(t,ATTRS.TYPE);n&&n.toLowerCase()===HIDDEN_INPUT_TYPE?e._appendElement(t,NS.HTML):tokenInTable(e,t)}function formStartTagInTable(e,t){e.formElement||(e._insertElement(t,NS.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function startTagInTable(e,t){var n=t.tagName;switch(n.length){case 2:n===$.TD||n===$.TH||n===$.TR?tdStartTagInTable(e,t):tokenInTable(e,t);break;case 3:n===$.COL?colStartTagInTable(e,t):tokenInTable(e,t);break;case 4:n===$.FORM?formStartTagInTable(e,t):tokenInTable(e,t);break;case 5:n===$.TABLE?tableStartTagInTable(e,t):n===$.STYLE?startTagInHead(e,t):n===$.TBODY||n===$.TFOOT||n===$.THEAD?tbodyStartTagInTable(e,t):n===$.INPUT?inputStartTagInTable(e,t):tokenInTable(e,t);break;case 6:n===$.SCRIPT?startTagInHead(e,t):tokenInTable(e,t);break;case 7:n===$.CAPTION?captionStartTagInTable(e,t):tokenInTable(e,t);break;case 8:n===$.COLGROUP?colgroupStartTagInTable(e,t):tokenInTable(e,t);break;default:tokenInTable(e,t)}}function endTagInTable(e,t){var n=t.tagName;n===$.TABLE?e.openElements.hasInTableScope($.TABLE)?(e.openElements.popUntilTagNamePopped($.TABLE),e._resetInsertionModeAppropriately()):t.ignored=!0:n!==$.BODY&&n!==$.CAPTION&&n!==$.COL&&n!==$.COLGROUP&&n!==$.HTML&&n!==$.TBODY&&n!==$.TD&&n!==$.TFOOT&&n!==$.TH&&n!==$.THEAD&&n!==$.TR&&tokenInTable(e,t)}function tokenInTable(e,t){var n=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,e._processTokenInBodyMode(t),e.fosterParentingEnabled=n}function whitespaceCharacterInTableText(e,t){e.pendingCharacterTokens.push(t)}function characterInTableText(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function tokenInTableText(e,t){if(e.hasNonWhitespacePendingCharacterToken)for(var n=0;n<e.pendingCharacterTokens.length;n++)tokenInTable(e,e.pendingCharacterTokens[n]);else for(var n=0;n<e.pendingCharacterTokens.length;n++)e._insertCharacters(e.pendingCharacterTokens[n]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}function startTagInCaption(e,t){var n=t.tagName;if(n===$.CAPTION||n===$.COL||n===$.COLGROUP||n===$.TBODY||n===$.TD||n===$.TFOOT||n===$.TH||n===$.THEAD||n===$.TR){var T=e._processFakeEndTag($.CAPTION);T.ignored||e._processToken(t)}else startTagInBody(e,t)}function endTagInCaption(e,t){var n=t.tagName;if(n===$.CAPTION)e.openElements.hasInTableScope($.CAPTION)?(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped($.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=IN_TABLE_MODE):t.ignored=!0;else if(n===$.TABLE){var T=e._processFakeEndTag($.CAPTION);T.ignored||e._processToken(t)}else n!==$.BODY&&n!==$.COL&&n!==$.COLGROUP&&n!==$.HTML&&n!==$.TBODY&&n!==$.TD&&n!==$.TFOOT&&n!==$.TH&&n!==$.THEAD&&n!==$.TR&&endTagInBody(e,t)}function startTagInColumnGroup(e,t){var n=t.tagName;n===$.HTML?startTagInBody(e,t):n===$.COL?e._appendElement(t,NS.HTML):tokenInColumnGroup(e,t)}function endTagInColumnGroup(e,t){var n=t.tagName;n===$.COLGROUP?e.openElements.isRootHtmlElementCurrent()?t.ignored=!0:(e.openElements.pop(),e.insertionMode=IN_TABLE_MODE):n!==$.COL&&tokenInColumnGroup(e,t)}function tokenInColumnGroup(e,t){var n=e._processFakeEndTag($.COLGROUP);n.ignored||e._processToken(t)}function startTagInTableBody(e,t){var n=t.tagName;n===$.TR?(e.openElements.clearBackToTableBodyContext(),e._insertElement(t,NS.HTML),e.insertionMode=IN_ROW_MODE):n===$.TH||n===$.TD?(e._processFakeStartTag($.TR),e._processToken(t)):n===$.CAPTION||n===$.COL||n===$.COLGROUP||n===$.TBODY||n===$.TFOOT||n===$.THEAD?e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e._processFakeEndTag(e.openElements.currentTagName),e._processToken(t)):startTagInTable(e,t)}function endTagInTableBody(e,t){var n=t.tagName;n===$.TBODY||n===$.TFOOT||n===$.THEAD?e.openElements.hasInTableScope(n)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=IN_TABLE_MODE):n===$.TABLE?e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e._processFakeEndTag(e.openElements.currentTagName),e._processToken(t)):(n!==$.BODY&&n!==$.CAPTION&&n!==$.COL&&n!==$.COLGROUP||n!==$.HTML&&n!==$.TD&&n!==$.TH&&n!==$.TR)&&endTagInTable(e,t)}function startTagInRow(e,t){var n=t.tagName;if(n===$.TH||n===$.TD)e.openElements.clearBackToTableRowContext(),e._insertElement(t,NS.HTML),e.insertionMode=IN_CELL_MODE,e.activeFormattingElements.insertMarker();else if(n===$.CAPTION||n===$.COL||n===$.COLGROUP||n===$.TBODY||n===$.TFOOT||n===$.THEAD||n===$.TR){var T=e._processFakeEndTag($.TR);T.ignored||e._processToken(t)}else startTagInTable(e,t)}function endTagInRow(e,t){var n=t.tagName;if(n===$.TR)e.openElements.hasInTableScope($.TR)?(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=IN_TABLE_BODY_MODE):t.ignored=!0;else if(n===$.TABLE){var T=e._processFakeEndTag($.TR);T.ignored||e._processToken(t)}else n===$.TBODY||n===$.TFOOT||n===$.THEAD?e.openElements.hasInTableScope(n)&&(e._processFakeEndTag($.TR),e._processToken(t)):(n!==$.BODY&&n!==$.CAPTION&&n!==$.COL&&n!==$.COLGROUP||n!==$.HTML&&n!==$.TD&&n!==$.TH)&&endTagInTable(e,t)}function startTagInCell(e,t){var n=t.tagName;n===$.CAPTION||n===$.COL||n===$.COLGROUP||n===$.TBODY||n===$.TD||n===$.TFOOT||n===$.TH||n===$.THEAD||n===$.TR?(e.openElements.hasInTableScope($.TD)||e.openElements.hasInTableScope($.TH))&&(e._closeTableCell(),e._processToken(t)):startTagInBody(e,t)}function endTagInCell(e,t){var n=t.tagName;n===$.TD||n===$.TH?e.openElements.hasInTableScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=IN_ROW_MODE):n===$.TABLE||n===$.TBODY||n===$.TFOOT||n===$.THEAD||n===$.TR?e.openElements.hasInTableScope(n)&&(e._closeTableCell(),e._processToken(t)):n!==$.BODY&&n!==$.CAPTION&&n!==$.COL&&n!==$.COLGROUP&&n!==$.HTML&&endTagInBody(e,t)}function startTagInSelect(e,t){var n=t.tagName;n===$.HTML?startTagInBody(e,t):n===$.OPTION?(e.openElements.currentTagName===$.OPTION&&e._processFakeEndTag($.OPTION),e._insertElement(t,NS.HTML)):n===$.OPTGROUP?(e.openElements.currentTagName===$.OPTION&&e._processFakeEndTag($.OPTION),e.openElements.currentTagName===$.OPTGROUP&&e._processFakeEndTag($.OPTGROUP),e._insertElement(t,NS.HTML)):n===$.SELECT?e._processFakeEndTag($.SELECT):n===$.INPUT||n===$.KEYGEN||n===$.TEXTAREA?e.openElements.hasInSelectScope($.SELECT)&&(e._processFakeEndTag($.SELECT),e._processToken(t)):n===$.SCRIPT&&startTagInHead(e,t)}function endTagInSelect(e,t){var n=t.tagName;if(n===$.OPTGROUP){var T=e.openElements.items[e.openElements.stackTop-1],r=T&&e.treeAdapter.getTagName(T);e.openElements.currentTagName===$.OPTION&&r===$.OPTGROUP&&e._processFakeEndTag($.OPTION),e.openElements.currentTagName===$.OPTGROUP&&e.openElements.pop()}else n===$.OPTION?e.openElements.currentTagName===$.OPTION&&e.openElements.pop():n===$.SELECT&&e.openElements.hasInSelectScope($.SELECT)&&(e.openElements.popUntilTagNamePopped($.SELECT),e._resetInsertionModeAppropriately())}function startTagInSelectInTable(e,t){var n=t.tagName;n===$.CAPTION||n===$.TABLE||n===$.TBODY||n===$.TFOOT||n===$.THEAD||n===$.TR||n===$.TD||n===$.TH?(e._processFakeEndTag($.SELECT),e._processToken(t)):startTagInSelect(e,t)}function endTagInSelectInTable(e,t){var n=t.tagName;n===$.CAPTION||n===$.TABLE||n===$.TBODY||n===$.TFOOT||n===$.THEAD||n===$.TR||n===$.TD||n===$.TH?e.openElements.hasInTableScope(n)&&(e._processFakeEndTag($.SELECT),e._processToken(t)):endTagInSelect(e,t)}function startTagAfterBody(e,t){t.tagName===$.HTML?startTagInBody(e,t):tokenAfterBody(e,t)}function endTagAfterBody(e,t){t.tagName===$.HTML?e.fragmentContext||(e.insertionMode=AFTER_AFTER_BODY_MODE):tokenAfterBody(e,t)}function tokenAfterBody(e,t){e.insertionMode=IN_BODY_MODE,e._processToken(t)}function startTagInFrameset(e,t){var n=t.tagName;n===$.HTML?startTagInBody(e,t):n===$.FRAMESET?e._insertElement(t,NS.HTML):n===$.FRAME?e._appendElement(t,NS.HTML):n===$.NOFRAMES&&startTagInHead(e,t)}function endTagInFrameset(e,t){t.tagName!==$.FRAMESET||e.openElements.isRootHtmlElementCurrent()||(e.openElements.pop(),e.fragmentContext||e.openElements.currentTagName===$.FRAMESET||(e.insertionMode=AFTER_FRAMESET_MODE))}function startTagAfterFrameset(e,t){var n=t.tagName;n===$.HTML?startTagInBody(e,t):n===$.NOFRAMES&&startTagInHead(e,t)}function endTagAfterFrameset(e,t){t.tagName===$.HTML&&(e.insertionMode=AFTER_AFTER_FRAMESET_MODE)}function startTagAfterAfterBody(e,t){t.tagName===$.HTML?startTagInBody(e,t):tokenAfterAfterBody(e,t)}function tokenAfterAfterBody(e,t){e.insertionMode=IN_BODY_MODE,e._processToken(t)}function startTagAfterAfterFrameset(e,t){var n=t.tagName;n===$.HTML?startTagInBody(e,t):n===$.NOFRAMES&&startTagInHead(e,t)}function nullCharacterInForeignContent(e,t){t.chars=UNICODE.REPLACEMENT_CHARACTER,e._insertCharacters(t)}function characterInForeignContent(e,t){e._insertCharacters(t),e.framesetOk=!1}function startTagInForeignContent(e,t){if(ForeignContent.causesExit(t)&&!e.fragmentContext){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==NS.HTML&&!e._isMathMLTextIntegrationPoint(e.openElements.current)&&!e._isHtmlIntegrationPoint(e.openElements.current);)e.openElements.pop();e._processToken(t)}else{var n=e._getAdjustedCurrentElement(),T=e.treeAdapter.getNamespaceURI(n);T===NS.MATHML?ForeignContent.adjustTokenMathMLAttrs(t):T===NS.SVG&&(ForeignContent.adjustTokenSVGTagName(t),ForeignContent.adjustTokenSVGAttrs(t)),ForeignContent.adjustTokenXMLAttrs(t),t.selfClosing?e._appendElement(t,T):e._insertElement(t,T)}}function endTagInForeignContent(e,t){for(var n=e.openElements.stackTop;n>0;n--){var T=e.openElements.items[n];if(e.treeAdapter.getNamespaceURI(T)===NS.HTML){e._processToken(t);break}if(e.treeAdapter.getTagName(T).toLowerCase()===t.tagName){e.openElements.popUntilElementPopped(T);break}}}var Tokenizer=require("../tokenization/tokenizer"),OpenElementStack=require("./open_element_stack"),FormattingElementList=require("./formatting_element_list"),Doctype=require("./doctype"),DefaultTreeAdapter=require("../tree_adapters/default"),ForeignContent=require("../common/foreign_content"),UNICODE=require("../common/unicode"),HTML=require("../common/html"),$=HTML.TAG_NAMES,NS=HTML.NAMESPACES,ATTRS=HTML.ATTRS,SEARCHABLE_INDEX_DEFAULT_PROMPT="This is a searchable index. Enter search keywords: ",SEARCHABLE_INDEX_INPUT_NAME="isindex",HIDDEN_INPUT_TYPE="hidden",INITIAL_MODE="INITIAL_MODE",BEFORE_HTML_MODE="BEFORE_HTML_MODE",BEFORE_HEAD_MODE="BEFORE_HEAD_MODE",IN_HEAD_MODE="IN_HEAD_MODE",AFTER_HEAD_MODE="AFTER_HEAD_MODE",IN_BODY_MODE="IN_BODY_MODE",TEXT_MODE="TEXT_MODE",IN_TABLE_MODE="IN_TABLE_MODE",IN_TABLE_TEXT_MODE="IN_TABLE_TEXT_MODE",IN_CAPTION_MODE="IN_CAPTION_MODE",IN_COLUMN_GROUP_MODE="IN_COLUMN_GROUP_MODE",IN_TABLE_BODY_MODE="IN_TABLE_BODY_MODE",IN_ROW_MODE="IN_ROW_MODE",IN_CELL_MODE="IN_CELL_MODE",IN_SELECT_MODE="IN_SELECT_MODE",IN_SELECT_IN_TABLE_MODE="IN_SELECT_IN_TABLE_MODE",AFTER_BODY_MODE="AFTER_BODY_MODE",IN_FRAMESET_MODE="IN_FRAMESET_MODE",AFTER_FRAMESET_MODE="AFTER_FRAMESET_MODE",AFTER_AFTER_BODY_MODE="AFTER_AFTER_BODY_MODE",AFTER_AFTER_FRAMESET_MODE="AFTER_AFTER_FRAMESET_MODE",INSERTION_MODE_RESET_MAP={};INSERTION_MODE_RESET_MAP[$.SELECT]=IN_SELECT_MODE,INSERTION_MODE_RESET_MAP[$.TR]=IN_ROW_MODE,INSERTION_MODE_RESET_MAP[$.TBODY]=INSERTION_MODE_RESET_MAP[$.THEAD]=INSERTION_MODE_RESET_MAP[$.TFOOT]=IN_TABLE_BODY_MODE,INSERTION_MODE_RESET_MAP[$.CAPTION]=IN_CAPTION_MODE,INSERTION_MODE_RESET_MAP[$.COLGROUP]=IN_COLUMN_GROUP_MODE,INSERTION_MODE_RESET_MAP[$.TABLE]=IN_TABLE_MODE,INSERTION_MODE_RESET_MAP[$.HEAD]=INSERTION_MODE_RESET_MAP[$.BODY]=IN_BODY_MODE,INSERTION_MODE_RESET_MAP[$.FRAMESET]=IN_FRAMESET_MODE,INSERTION_MODE_RESET_MAP[$.HTML]=BEFORE_HEAD_MODE;var _={};_[INITIAL_MODE]={},_[INITIAL_MODE][Tokenizer.CHARACTER_TOKEN]=_[INITIAL_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=tokenInInitialMode,_[INITIAL_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=ignoreToken,_[INITIAL_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[INITIAL_MODE][Tokenizer.DOCTYPE_TOKEN]=doctypeInInitialMode,_[INITIAL_MODE][Tokenizer.START_TAG_TOKEN]=_[INITIAL_MODE][Tokenizer.END_TAG_TOKEN]=_[INITIAL_MODE][Tokenizer.EOF_TOKEN]=tokenInInitialMode,_[BEFORE_HTML_MODE]={},_[BEFORE_HTML_MODE][Tokenizer.CHARACTER_TOKEN]=_[BEFORE_HTML_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=tokenBeforeHtml,_[BEFORE_HTML_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=ignoreToken,_[BEFORE_HTML_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[BEFORE_HTML_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[BEFORE_HTML_MODE][Tokenizer.START_TAG_TOKEN]=startTagBeforeHtml,_[BEFORE_HTML_MODE][Tokenizer.END_TAG_TOKEN]=endTagBeforeHtml,_[BEFORE_HTML_MODE][Tokenizer.EOF_TOKEN]=tokenBeforeHtml,_[BEFORE_HEAD_MODE]={},_[BEFORE_HEAD_MODE][Tokenizer.CHARACTER_TOKEN]=_[BEFORE_HEAD_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=tokenBeforeHead,_[BEFORE_HEAD_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=ignoreToken,_[BEFORE_HEAD_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[BEFORE_HEAD_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[BEFORE_HEAD_MODE][Tokenizer.START_TAG_TOKEN]=startTagBeforeHead,_[BEFORE_HEAD_MODE][Tokenizer.END_TAG_TOKEN]=endTagBeforeHead,_[BEFORE_HEAD_MODE][Tokenizer.EOF_TOKEN]=tokenBeforeHead,_[IN_HEAD_MODE]={},_[IN_HEAD_MODE][Tokenizer.CHARACTER_TOKEN]=_[IN_HEAD_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=tokenInHead,_[IN_HEAD_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=insertCharacters,_[IN_HEAD_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[IN_HEAD_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[IN_HEAD_MODE][Tokenizer.START_TAG_TOKEN]=startTagInHead,_[IN_HEAD_MODE][Tokenizer.END_TAG_TOKEN]=endTagInHead,_[IN_HEAD_MODE][Tokenizer.EOF_TOKEN]=tokenInHead,_[AFTER_HEAD_MODE]={},_[AFTER_HEAD_MODE][Tokenizer.CHARACTER_TOKEN]=_[AFTER_HEAD_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=tokenAfterHead,_[AFTER_HEAD_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=insertCharacters,_[AFTER_HEAD_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[AFTER_HEAD_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[AFTER_HEAD_MODE][Tokenizer.START_TAG_TOKEN]=startTagAfterHead,_[AFTER_HEAD_MODE][Tokenizer.END_TAG_TOKEN]=endTagAfterHead,_[AFTER_HEAD_MODE][Tokenizer.EOF_TOKEN]=tokenAfterHead,_[IN_BODY_MODE]={},_[IN_BODY_MODE][Tokenizer.CHARACTER_TOKEN]=characterInBody,_[IN_BODY_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=ignoreToken,
_[IN_BODY_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=whitespaceCharacterInBody,_[IN_BODY_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[IN_BODY_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[IN_BODY_MODE][Tokenizer.START_TAG_TOKEN]=startTagInBody,_[IN_BODY_MODE][Tokenizer.END_TAG_TOKEN]=endTagInBody,_[IN_BODY_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[TEXT_MODE]={},_[TEXT_MODE][Tokenizer.CHARACTER_TOKEN]=_[TEXT_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=_[TEXT_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=insertCharacters,_[TEXT_MODE][Tokenizer.COMMENT_TOKEN]=_[TEXT_MODE][Tokenizer.DOCTYPE_TOKEN]=_[TEXT_MODE][Tokenizer.START_TAG_TOKEN]=ignoreToken,_[TEXT_MODE][Tokenizer.END_TAG_TOKEN]=endTagInText,_[TEXT_MODE][Tokenizer.EOF_TOKEN]=eofInText,_[IN_TABLE_MODE]={},_[IN_TABLE_MODE][Tokenizer.CHARACTER_TOKEN]=_[IN_TABLE_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=_[IN_TABLE_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=characterInTable,_[IN_TABLE_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[IN_TABLE_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[IN_TABLE_MODE][Tokenizer.START_TAG_TOKEN]=startTagInTable,_[IN_TABLE_MODE][Tokenizer.END_TAG_TOKEN]=endTagInTable,_[IN_TABLE_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[IN_TABLE_TEXT_MODE]={},_[IN_TABLE_TEXT_MODE][Tokenizer.CHARACTER_TOKEN]=characterInTableText,_[IN_TABLE_TEXT_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=ignoreToken,_[IN_TABLE_TEXT_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=whitespaceCharacterInTableText,_[IN_TABLE_TEXT_MODE][Tokenizer.COMMENT_TOKEN]=_[IN_TABLE_TEXT_MODE][Tokenizer.DOCTYPE_TOKEN]=_[IN_TABLE_TEXT_MODE][Tokenizer.START_TAG_TOKEN]=_[IN_TABLE_TEXT_MODE][Tokenizer.END_TAG_TOKEN]=_[IN_TABLE_TEXT_MODE][Tokenizer.EOF_TOKEN]=tokenInTableText,_[IN_CAPTION_MODE]={},_[IN_CAPTION_MODE][Tokenizer.CHARACTER_TOKEN]=characterInBody,_[IN_CAPTION_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=ignoreToken,_[IN_CAPTION_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=whitespaceCharacterInBody,_[IN_CAPTION_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[IN_CAPTION_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[IN_CAPTION_MODE][Tokenizer.START_TAG_TOKEN]=startTagInCaption,_[IN_CAPTION_MODE][Tokenizer.END_TAG_TOKEN]=endTagInCaption,_[IN_CAPTION_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[IN_COLUMN_GROUP_MODE]={},_[IN_COLUMN_GROUP_MODE][Tokenizer.CHARACTER_TOKEN]=_[IN_COLUMN_GROUP_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=tokenInColumnGroup,_[IN_COLUMN_GROUP_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=insertCharacters,_[IN_COLUMN_GROUP_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[IN_COLUMN_GROUP_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[IN_COLUMN_GROUP_MODE][Tokenizer.START_TAG_TOKEN]=startTagInColumnGroup,_[IN_COLUMN_GROUP_MODE][Tokenizer.END_TAG_TOKEN]=endTagInColumnGroup,_[IN_COLUMN_GROUP_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[IN_TABLE_BODY_MODE]={},_[IN_TABLE_BODY_MODE][Tokenizer.CHARACTER_TOKEN]=_[IN_TABLE_BODY_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=_[IN_TABLE_BODY_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=characterInTable,_[IN_TABLE_BODY_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[IN_TABLE_BODY_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[IN_TABLE_BODY_MODE][Tokenizer.START_TAG_TOKEN]=startTagInTableBody,_[IN_TABLE_BODY_MODE][Tokenizer.END_TAG_TOKEN]=endTagInTableBody,_[IN_TABLE_BODY_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[IN_ROW_MODE]={},_[IN_ROW_MODE][Tokenizer.CHARACTER_TOKEN]=_[IN_ROW_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=_[IN_ROW_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=characterInTable,_[IN_ROW_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[IN_ROW_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[IN_ROW_MODE][Tokenizer.START_TAG_TOKEN]=startTagInRow,_[IN_ROW_MODE][Tokenizer.END_TAG_TOKEN]=endTagInRow,_[IN_ROW_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[IN_CELL_MODE]={},_[IN_CELL_MODE][Tokenizer.CHARACTER_TOKEN]=characterInBody,_[IN_CELL_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=ignoreToken,_[IN_CELL_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=whitespaceCharacterInBody,_[IN_CELL_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[IN_CELL_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[IN_CELL_MODE][Tokenizer.START_TAG_TOKEN]=startTagInCell,_[IN_CELL_MODE][Tokenizer.END_TAG_TOKEN]=endTagInCell,_[IN_CELL_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[IN_SELECT_MODE]={},_[IN_SELECT_MODE][Tokenizer.CHARACTER_TOKEN]=insertCharacters,_[IN_SELECT_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=ignoreToken,_[IN_SELECT_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=insertCharacters,_[IN_SELECT_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[IN_SELECT_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[IN_SELECT_MODE][Tokenizer.START_TAG_TOKEN]=startTagInSelect,_[IN_SELECT_MODE][Tokenizer.END_TAG_TOKEN]=endTagInSelect,_[IN_SELECT_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[IN_SELECT_IN_TABLE_MODE]={},_[IN_SELECT_IN_TABLE_MODE][Tokenizer.CHARACTER_TOKEN]=insertCharacters,_[IN_SELECT_IN_TABLE_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=ignoreToken,_[IN_SELECT_IN_TABLE_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=insertCharacters,_[IN_SELECT_IN_TABLE_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[IN_SELECT_IN_TABLE_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[IN_SELECT_IN_TABLE_MODE][Tokenizer.START_TAG_TOKEN]=startTagInSelectInTable,_[IN_SELECT_IN_TABLE_MODE][Tokenizer.END_TAG_TOKEN]=endTagInSelectInTable,_[IN_SELECT_IN_TABLE_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[AFTER_BODY_MODE]={},_[AFTER_BODY_MODE][Tokenizer.CHARACTER_TOKEN]=_[AFTER_BODY_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=tokenAfterBody,_[AFTER_BODY_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=whitespaceCharacterInBody,_[AFTER_BODY_MODE][Tokenizer.COMMENT_TOKEN]=appendCommentToRootHtmlElement,_[AFTER_BODY_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[AFTER_BODY_MODE][Tokenizer.START_TAG_TOKEN]=startTagAfterBody,_[AFTER_BODY_MODE][Tokenizer.END_TAG_TOKEN]=endTagAfterBody,_[AFTER_BODY_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[IN_FRAMESET_MODE]={},_[IN_FRAMESET_MODE][Tokenizer.CHARACTER_TOKEN]=_[IN_FRAMESET_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=ignoreToken,_[IN_FRAMESET_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=insertCharacters,_[IN_FRAMESET_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[IN_FRAMESET_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[IN_FRAMESET_MODE][Tokenizer.START_TAG_TOKEN]=startTagInFrameset,_[IN_FRAMESET_MODE][Tokenizer.END_TAG_TOKEN]=endTagInFrameset,_[IN_FRAMESET_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[AFTER_FRAMESET_MODE]={},_[AFTER_FRAMESET_MODE][Tokenizer.CHARACTER_TOKEN]=_[AFTER_FRAMESET_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=ignoreToken,_[AFTER_FRAMESET_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=insertCharacters,_[AFTER_FRAMESET_MODE][Tokenizer.COMMENT_TOKEN]=appendComment,_[AFTER_FRAMESET_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[AFTER_FRAMESET_MODE][Tokenizer.START_TAG_TOKEN]=startTagAfterFrameset,_[AFTER_FRAMESET_MODE][Tokenizer.END_TAG_TOKEN]=endTagAfterFrameset,_[AFTER_FRAMESET_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[AFTER_AFTER_BODY_MODE]={},_[AFTER_AFTER_BODY_MODE][Tokenizer.CHARACTER_TOKEN]=tokenAfterAfterBody,_[AFTER_AFTER_BODY_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=tokenAfterAfterBody,_[AFTER_AFTER_BODY_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=whitespaceCharacterInBody,_[AFTER_AFTER_BODY_MODE][Tokenizer.COMMENT_TOKEN]=appendCommentToDocument,_[AFTER_AFTER_BODY_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[AFTER_AFTER_BODY_MODE][Tokenizer.START_TAG_TOKEN]=startTagAfterAfterBody,_[AFTER_AFTER_BODY_MODE][Tokenizer.END_TAG_TOKEN]=tokenAfterAfterBody,_[AFTER_AFTER_BODY_MODE][Tokenizer.EOF_TOKEN]=stopParsing,_[AFTER_AFTER_FRAMESET_MODE]={},_[AFTER_AFTER_FRAMESET_MODE][Tokenizer.CHARACTER_TOKEN]=_[AFTER_AFTER_FRAMESET_MODE][Tokenizer.NULL_CHARACTER_TOKEN]=ignoreToken,_[AFTER_AFTER_FRAMESET_MODE][Tokenizer.WHITESPACE_CHARACTER_TOKEN]=whitespaceCharacterInBody,_[AFTER_AFTER_FRAMESET_MODE][Tokenizer.COMMENT_TOKEN]=appendCommentToDocument,_[AFTER_AFTER_FRAMESET_MODE][Tokenizer.DOCTYPE_TOKEN]=ignoreToken,_[AFTER_AFTER_FRAMESET_MODE][Tokenizer.START_TAG_TOKEN]=startTagAfterAfterFrameset,_[AFTER_AFTER_FRAMESET_MODE][Tokenizer.END_TAG_TOKEN]=ignoreToken,_[AFTER_AFTER_FRAMESET_MODE][Tokenizer.EOF_TOKEN]=stopParsing;var Parser=module.exports=function(e){this.treeAdapter=e||DefaultTreeAdapter,this.scriptHandler=null};Parser.prototype.parse=function(e){var t=this.treeAdapter.createDocument();return this._reset(e,t,null),this._runParsingLoop(),t},Parser.prototype.parseFragment=function(e,t){t||(t=this.treeAdapter.createElement($.DIV,NS.HTML,[]));var n=this.treeAdapter.createElement("documentmock",NS.HTML,[]);this._reset(e,n,t),this._initTokenizerForFragmentParsing(),this._insertFakeRootElement(),this._resetInsertionModeAppropriately(),this._findFormInFragmentContext(),this._runParsingLoop();var T=this.treeAdapter.getFirstChild(n),r=this.treeAdapter.createDocumentFragment();return this._adoptNodes(T,r),r},Parser.prototype._reset=function(e,t,n){this.tokenizer=new Tokenizer(e),this.stopped=!1,this.insertionMode=INITIAL_MODE,this.originalInsertionMode="",this.document=t,this.fragmentContext=n,this.headElement=null,this.formElement=null,this.openElements=new OpenElementStack(this.document,this.treeAdapter),this.activeFormattingElements=new FormattingElementList(this.treeAdapter),this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1},Parser.prototype._iterateParsingLoop=function(){this._setupTokenizerCDATAMode();var e=this.tokenizer.getNextToken();if(this.skipNextNewLine&&(this.skipNextNewLine=!1,e.type===Tokenizer.WHITESPACE_CHARACTER_TOKEN&&"\n"===e.chars[0])){if(1===e.chars.length)return;e.chars=e.chars.substr(1)}this._shouldProcessTokenInForeignContent(e)?this._processTokenInForeignContent(e):this._processToken(e)},Parser.prototype._runParsingLoop=function(){for(;!this.stopped;)this._iterateParsingLoop()},Parser.prototype._setupTokenizerCDATAMode=function(){var e=this._getAdjustedCurrentElement();this.tokenizer.allowCDATA=e&&e!==this.document&&this.treeAdapter.getNamespaceURI(e)!==NS.HTML&&!this._isHtmlIntegrationPoint(e)&&!this._isMathMLTextIntegrationPoint(e)},Parser.prototype._switchToTextParsing=function(e,t){this._insertElement(e,NS.HTML),this.tokenizer.state=t,this.originalInsertionMode=this.insertionMode,this.insertionMode=TEXT_MODE},Parser.prototype._getAdjustedCurrentElement=function(){return 0===this.openElements.stackTop&&this.fragmentContext?this.fragmentContext:this.openElements.current},Parser.prototype._findFormInFragmentContext=function(){var e=this.fragmentContext;do{if(this.treeAdapter.getTagName(e)===$.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}while(e)},Parser.prototype._initTokenizerForFragmentParsing=function(){var e=this.treeAdapter.getTagName(this.fragmentContext);e===$.TITLE||e===$.TEXTAREA?this.tokenizer.state=Tokenizer.RCDATA_STATE:e===$.STYLE||e===$.XMP||e===$.IFRAME||e===$.NOEMBED||e===$.NOFRAMES||e===$.NOSCRIPT?this.tokenizer.state=Tokenizer.RAWTEXT_STATE:e===$.SCRIPT?this.tokenizer.state=Tokenizer.SCRIPT_DATA_STATE:e===$.PLAINTEXT&&(this.tokenizer.state=Tokenizer.PLAINTEXT_STATE)},Parser.prototype._setDocumentType=function(e){this.treeAdapter.setDocumentType(this.document,e.name,e.publicId,e.systemId)},Parser.prototype._attachElementToTree=function(e){this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.current)?this._fosterParentElement(e):this.treeAdapter.appendChild(this.openElements.current,e)},Parser.prototype._appendElement=function(e,t){var n=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(n)},Parser.prototype._insertElement=function(e,t){var n=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(n),this.openElements.push(n)},Parser.prototype._insertFakeRootElement=function(){var e=this.treeAdapter.createElement($.HTML,NS.HTML,[]);this.treeAdapter.appendChild(this.openElements.current,e),this.openElements.push(e)},Parser.prototype._appendCommentNode=function(e,t){var n=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(t,n)},Parser.prototype._insertCharacters=function(e){if(this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.current)){var t=this._findFosterParentingLocation();t.beforeElement?this.treeAdapter.insertTextBefore(t.parent,e.chars,t.beforeElement):this.treeAdapter.insertText(t.parent,e.chars)}else this.treeAdapter.insertText(this.openElements.current,e.chars)},Parser.prototype._adoptNodes=function(e,t){for(;;){var n=this.treeAdapter.getFirstChild(e);if(!n)break;this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(t,n)}},Parser.prototype._shouldProcessTokenInForeignContent=function(e){var t=this._getAdjustedCurrentElement();if(!t||t===this.document)return!1;var n=this.treeAdapter.getNamespaceURI(t);if(n===NS.HTML)return!1;if(this.treeAdapter.getTagName(t)===$.ANNOTATION_XML&&n===NS.MATHML&&e.type===Tokenizer.START_TAG_TOKEN&&e.tagName===$.SVG)return!1;var T=e.type===Tokenizer.CHARACTER_TOKEN||e.type===Tokenizer.NULL_CHARACTER_TOKEN||e.type===Tokenizer.WHITESPACE_CHARACTER_TOKEN,r=e.type===Tokenizer.START_TAG_TOKEN&&e.tagName!==$.MGLYPH&&e.tagName!==$.MALIGNMARK;return(!r&&!T||!this._isMathMLTextIntegrationPoint(t))&&((e.type!==Tokenizer.START_TAG_TOKEN&&!T||!this._isHtmlIntegrationPoint(t))&&e.type!==Tokenizer.EOF_TOKEN)},Parser.prototype._processToken=function(e){_[this.insertionMode][e.type](this,e)},Parser.prototype._processTokenInBodyMode=function(e){_[IN_BODY_MODE][e.type](this,e)},Parser.prototype._processTokenInForeignContent=function(e){e.type===Tokenizer.CHARACTER_TOKEN?characterInForeignContent(this,e):e.type===Tokenizer.NULL_CHARACTER_TOKEN?nullCharacterInForeignContent(this,e):e.type===Tokenizer.WHITESPACE_CHARACTER_TOKEN?insertCharacters(this,e):e.type===Tokenizer.COMMENT_TOKEN?appendComment(this,e):e.type===Tokenizer.START_TAG_TOKEN?startTagInForeignContent(this,e):e.type===Tokenizer.END_TAG_TOKEN&&endTagInForeignContent(this,e)},Parser.prototype._processFakeStartTagWithAttrs=function(e,t){var n=this.tokenizer.buildStartTagToken(e);n.attrs=t,this._processToken(n)},Parser.prototype._processFakeStartTag=function(e){var t=this.tokenizer.buildStartTagToken(e);return this._processToken(t),t},Parser.prototype._processFakeEndTag=function(e){var t=this.tokenizer.buildEndTagToken(e);return this._processToken(t),t},Parser.prototype._isMathMLTextIntegrationPoint=function(e){var t=this.treeAdapter.getTagName(e),n=this.treeAdapter.getNamespaceURI(e);return ForeignContent.isMathMLTextIntegrationPoint(t,n)},Parser.prototype._isHtmlIntegrationPoint=function(e){var t=this.treeAdapter.getTagName(e),n=this.treeAdapter.getNamespaceURI(e),T=this.treeAdapter.getAttrList(e);return ForeignContent.isHtmlIntegrationPoint(t,n,T)},Parser.prototype._reconstructActiveFormattingElements=function(){var e=this.activeFormattingElements.length;if(e){var t=e,n=null;do if(t--,n=this.activeFormattingElements.entries[t],n.type===FormattingElementList.MARKER_ENTRY||this.openElements.contains(n.element)){t++;break}while(t>0);for(var T=t;T<e;T++)n=this.activeFormattingElements.entries[T],this._insertElement(n.token,this.treeAdapter.getNamespaceURI(n.element)),n.element=this.openElements.current}},Parser.prototype._closeTableCell=function(){this.openElements.hasInTableScope($.TD)?this._processFakeEndTag($.TD):this._processFakeEndTag($.TH)},Parser.prototype._closePElement=function(){this.openElements.generateImpliedEndTagsWithExclusion($.P),this.openElements.popUntilTagNamePopped($.P)},Parser.prototype._resetInsertionModeAppropriately=function(){for(var e=this.openElements.stackTop,t=!1;e>=0;e--){var n=this.openElements.items[e];this.openElements.items[0]===n&&(t=!0,n=this.fragmentContext);var T=this.treeAdapter.getTagName(n),r=INSERTION_MODE_RESET_MAP[T];if(r){this.insertionMode=r;break}if(!(t||T!==$.TD&&T!==$.TH)){this.insertionMode=IN_CELL_MODE;break}if(t){this.insertionMode=IN_BODY_MODE;break}}},Parser.prototype._obtainFormattingElementEntryForAdoptionAgency=function(e){var t=e.tagName,n=this.activeFormattingElements.getElementEntryInScopeWithTagName(t);return n?this.openElements.contains(n.element)?this.openElements.hasInScope(t)||(n=null):(this.activeFormattingElements.removeEntry(n),n=null):genericEndTagInBody(this,e),n},Parser.prototype._obtainFurthestBlockForAdoptionAgency=function(e){for(var t=null,n=this.openElements.stackTop;n>=0;n--){var T=this.openElements.items[n];if(T===e.element)break;this._isSpecialElement(T)&&(t=T)}return t||(this.openElements.popUntilElementPopped(e.element),this.activeFormattingElements.removeEntry(e)),t},Parser.prototype._recreateElementForAdoptionAgency=function(e){var t=this.treeAdapter.getNamespaceURI(e.element),n=this.treeAdapter.createElement(e.token.tagName,t,e.token.attrs);return this.openElements.replace(e.element,n),e.element=n,n},Parser.prototype._adoptionAgencyInnerLoop=function(e,t){for(var n=null,T=e,r=this.openElements.getCommonAncestor(e),o=0;o<3;o++){n=r,r=this.openElements.getCommonAncestor(n);var a=this.activeFormattingElements.getElementEntry(n);if(a){if(n===t)break;n=this._recreateElementForAdoptionAgency(a),T===e&&(this.activeFormattingElements.bookmark=a),this.treeAdapter.detachNode(T),this.treeAdapter.appendChild(n,T),T=n}else this.openElements.remove(n)}return T},Parser.prototype._replaceFormattingElementForAdoptionAgency=function(e,t){var n=this.treeAdapter.getNamespaceURI(t.element),T=t.token,r=this.treeAdapter.createElement(T.tagName,n,T.attrs);this._adoptNodes(e,r),this.treeAdapter.appendChild(e,r),this.activeFormattingElements.insertElementAfterBookmark(r,t.token),this.activeFormattingElements.removeEntry(t),this.openElements.remove(t.element),this.openElements.insertAfter(e,r)},Parser.prototype._callAdoptionAgency=function(e){for(var t=0;t<8;t++){var n=this._obtainFormattingElementEntryForAdoptionAgency(e);if(!n)break;var T=this._obtainFurthestBlockForAdoptionAgency(n);if(!T)break;this.activeFormattingElements.bookmark=n;var r=this._adoptionAgencyInnerLoop(T,n.element),o=this.openElements.getCommonAncestor(n.element);this.treeAdapter.detachNode(r),this._isElementCausesFosterParenting(o)?this._fosterParentElement(r):this.treeAdapter.appendChild(o,r),this._replaceFormattingElementForAdoptionAgency(T,n)}},Parser.prototype._isElementCausesFosterParenting=function(e){var t=this.treeAdapter.getTagName(e);return t===$.TABLE||t===$.TBODY||t===$.TFOOT||t==$.THEAD||t===$.TR},Parser.prototype._findFosterParentingLocation=function(){for(var e={parent:null,beforeElement:null},t=this.openElements.stackTop;t>=0;t--){var n=this.openElements.items[t];if(this.treeAdapter.getTagName(n)===$.TABLE){e.parent=this.treeAdapter.getParentNode(n),e.parent?e.beforeElement=n:e.parent=this.openElements.items[t-1];break}}return e.parent||(e.parent=this.openElements.items[0]),e},Parser.prototype._fosterParentElement=function(e){var t=this._findFosterParentingLocation();t.beforeElement?this.treeAdapter.insertBefore(t.parent,e,t.beforeElement):this.treeAdapter.appendChild(t.parent,e)},Parser.prototype._isSpecialElement=function(e){var t=this.treeAdapter.getTagName(e),n=this.treeAdapter.getNamespaceURI(e);return HTML.SPECIAL_ELEMENTS[n][t]};